
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>modelparameters.sympy.simplify package &#8212; modelparameters 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="modelparameters.sympy.solvers package" href="modelparameters.sympy.solvers.html" />
    <link rel="prev" title="modelparameters.sympy.sets package" href="modelparameters.sympy.sets.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelparameters.sympy.solvers.html" title="modelparameters.sympy.solvers package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modelparameters.sympy.sets.html" title="modelparameters.sympy.sets package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">modelparameters 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modelparameters.html" >modelparameters package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="modelparameters.sympy.html" accesskey="U">modelparameters.sympy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">modelparameters.sympy.simplify package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="modelparameters-sympy-simplify-package">
<h1>modelparameters.sympy.simplify package<a class="headerlink" href="#modelparameters-sympy-simplify-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-modelparameters.sympy.simplify.combsimp">
<span id="modelparameters-sympy-simplify-combsimp-module"></span><h2>modelparameters.sympy.simplify.combsimp module<a class="headerlink" href="#module-modelparameters.sympy.simplify.combsimp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.combsimp.combsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.combsimp.</span></span><span class="sig-name descname"><span class="pre">combsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/combsimp.html#combsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.combsimp.combsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify combinatorial expressions.</p>
<p>This function takes as input an expression containing factorials,
binomials, Pochhammer symbol and other “combinatorial” functions,
and tries to minimize the number of those functions and reduce
the size of their arguments.</p>
<p>The algorithm works by rewriting all combinatorial functions as
expressions involving rising factorials (Pochhammer symbols) and
applies recurrence relations and other transformations applicable
to rising factorials, to reduce their arguments, possibly letting
the resulting rising factorial to cancel. Rising factorials with
the second argument being an integer are expanded into polynomial
forms and finally all other rising factorial are rewritten in terms
of more familiar functions. If the initial expression consisted of
gamma functions alone, the result is expressed in terms of gamma
functions. If the initial expression consists of gamma function
with some other combinatorial, the result is expressed in terms of
gamma functions.</p>
<p>If the result is expressed using gamma functions, the following three
additional steps are performed:</p>
<ol class="arabic simple">
<li><p>Reduce the number of gammas by applying the reflection theorem
gamma(x)*gamma(1-x) == pi/sin(pi*x).</p></li>
<li><p>Reduce the number of gammas by applying the multiplication theorem
gamma(x)*gamma(x+1/n)*…*gamma(x+(n-1)/n) == C*gamma(n*x).</p></li>
<li><p>Reduce the number of prefactors by absorbing them into gammas, where
possible.</p></li>
</ol>
<p>All transformation rules can be found (or was derived from) here:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://functions.wolfram.com/GammaBetaErf/Pochhammer/17/01/02/">http://functions.wolfram.com/GammaBetaErf/Pochhammer/17/01/02/</a></p></li>
<li><p><a class="reference external" href="http://functions.wolfram.com/GammaBetaErf/Pochhammer/27/01/0005/">http://functions.wolfram.com/GammaBetaErf/Pochhammer/27/01/0005/</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..simplify</span> <span class="kn">import</span> <span class="n">combsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">binomial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">n*(n - 2)*(n - 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combsimp</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="go">(n + 1)/(k + 1)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.cse_main">
<span id="modelparameters-sympy-simplify-cse-main-module"></span><h2>modelparameters.sympy.simplify.cse_main module<a class="headerlink" href="#module-modelparameters.sympy.simplify.cse_main" title="Permalink to this heading">¶</a></h2>
<p>Tools for doing common subexpression elimination.</p>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.cse">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">cse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#cse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform common subexpression elimination on an expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>sympy expressions</em><em>, or </em><em>a single sympy expression</em>) – The expressions to reduce.</p></li>
<li><p><strong>symbols</strong> (<em>infinite iterator yielding unique Symbols</em>) – The symbols used to label the common subexpressions which are pulled
out. The <code class="docutils literal notranslate"><span class="pre">numbered_symbols</span></code> generator is useful. The default is a
stream of symbols of the form “x0”, “x1”, etc. This must be an
infinite iterator.</p></li>
<li><p><strong>optimizations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>(</em><em>callable</em><em>, </em><em>callable</em><em>) </em><em>pairs</em>) – The (preprocessor, postprocessor) pairs of external optimization
functions. Optionally ‘basic’ can be passed for a set of predefined
basic optimizations. Such ‘basic’ optimizations were used by default
in old implementation, however they can be really slow on larger
expressions. Now, no pre or post optimizations are made by default.</p></li>
<li><p><strong>postprocess</strong> (<em>a function which accepts the two return values</em><em> of </em><em>cse and</em>) – returns the desired form of output from cse, e.g. if you want the
replacements reversed the function might be the following lambda:
lambda r, e: return reversed(r), e</p></li>
<li><p><strong>order</strong> (<em>string</em><em>, </em><em>'none'</em><em> or </em><em>'canonical'</em>) – The order by which Mul and Add arguments are processed. If set to
‘canonical’, arguments will be canonically ordered. If set to ‘none’,
ordering will be faster but dependent on expressions hashes, thus
machine dependent and variable. For large expressions where speed is a
concern, use the setting order=’none’.</p></li>
<li><p><strong>ignore</strong> (<em>iterable</em><em> of </em><em>Symbols</em>) – Substitutions containing any Symbol from <code class="docutils literal notranslate"><span class="pre">ignore</span></code> will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>replacements</strong> (<em>list of (Symbol, expression) pairs</em>) – All of the common subexpressions that were replaced. Subexpressions
earlier in this list might show up in subexpressions later in this
list.</p></li>
<li><p><strong>reduced_exprs</strong> (<em>list of sympy expressions</em>) – The reduced expressions with all of the replacements above.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cse</span><span class="p">,</span> <span class="n">SparseMatrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(((</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([(x0, y + z), (x1, w + x)], [(w + x0)*(x0 + x1)/x1**3])</span>
</pre></div>
</div>
<p>Note that currently, y + z will not get substituted if -y - z is used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">(((</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([(x0, w + x)], [(w - y - z)*(x0 + y + z)/x0**3])</span>
</pre></div>
</div>
<p>List of expressions with recursive substitutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">SparseMatrix</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">([(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">])</span>
<span class="go">([(x0, x + y), (x1, x0 + z)], [x0**2, x1, y + z, x1, Matrix([</span>
<span class="go">[x0],</span>
<span class="go">[x1]])])</span>
</pre></div>
</div>
<p>Note: the type and mutability of input matrices is retained.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">SparseMatrix</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The user may disallow substitutions containing certain symbols:
&gt;&gt;&gt; cse([y**2*(x + 1), 3*y**2*(x + 1)], ignore=(y,))
([(x0, x + 1)], [x0*y**2, 3*x0*y**2])</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.cse_separate">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">cse_separate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#cse_separate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.cse_separate" title="Permalink to this definition">¶</a></dt>
<dd><p>Move expressions that are in the form (symbol, expr) out of the
expressions and sort them into the replacements using the reps_toposort.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.cse_main</span> <span class="kn">import</span> <span class="n">cse_separate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cse</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x:2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cse</span><span class="p">([</span><span class="n">eq</span><span class="p">,</span> <span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">cse_separate</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">... </span><span class="p">[[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span> <span class="p">[</span><span class="n">x1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x1</span><span class="o">/</span><span class="n">x0</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]],</span>
<span class="gp">... </span><span class="p">[[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span> <span class="p">[</span><span class="n">x0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x0</span><span class="o">/</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]]]</span>
<span class="gp">...</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.opt_cse">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">opt_cse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#opt_cse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.opt_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Find optimization opportunities in Adds, Muls, Pows and negative
coefficient Muls</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>sympy expressions</em>) – The expressions to optimize.</p></li>
<li><p><strong>order</strong> (<em>string</em><em>, </em><em>'none'</em><em> or </em><em>'canonical'</em>) – The order by which Mul and Add arguments are processed. For large
expressions where speed is a concern, use the setting order=’none’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>opt_subs</strong> – The expression substitutions which can be useful to optimize CSE.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of expression substitutions</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.cse_main</span> <span class="kn">import</span> <span class="n">opt_cse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt_subs</span> <span class="o">=</span> <span class="n">opt_cse</span><span class="p">([</span><span class="n">x</span><span class="o">**-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">opt_subs</span><span class="p">)</span>
<span class="go">{x**(-2): 1/(x**2)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.postprocess_for_cse">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">postprocess_for_cse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#postprocess_for_cse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.postprocess_for_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Postprocess an expression after common subexpression elimination to
return the expression to canonical sympy form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>sympy expression</em>) – The target expression to transform.</p></li>
<li><p><strong>optimizations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>(</em><em>callable</em><em>, </em><em>callable</em><em>) </em><em>pairs</em><em>, </em><em>optional</em>) – The (preprocessor, postprocessor) pairs.  The postprocessors will be
applied in reversed order to undo the effects of the preprocessors
correctly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>expr</strong> – The transformed expression.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy expression</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.preprocess_for_cse">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">preprocess_for_cse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#preprocess_for_cse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.preprocess_for_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess an expression to optimize for common subexpression
elimination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>sympy expression</em>) – The target expression to optimize.</p></li>
<li><p><strong>optimizations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>(</em><em>callable</em><em>, </em><em>callable</em><em>) </em><em>pairs</em>) – The (preprocessor, postprocessor) pairs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>expr</strong> – The transformed expression.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy expression</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.reps_toposort">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">reps_toposort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#reps_toposort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.reps_toposort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort replacements <cite>r</cite> so (k1, v1) appears before (k2, v2)
if k2 is in v1’s free symbols. This orders items in the
way that cse returns its results (hence, in order to use the
replacements in a substitution option it would make sense
to reverse the order).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.cse_main</span> <span class="kn">import</span> <span class="n">reps_toposort</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Eq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reps_toposort</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">Eq(y, 2)</span>
<span class="go">Eq(x, y + 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_main.tree_cse">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_main.</span></span><span class="sig-name descname"><span class="pre">tree_cse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_subs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'canonical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_main.html#tree_cse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_main.tree_cse" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform raw CSE on expression tree, taking opt_subs into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em> of </em><em>sympy expressions</em>) – The expressions to reduce.</p></li>
<li><p><strong>symbols</strong> (<em>infinite iterator yielding unique Symbols</em>) – The symbols used to label the common subexpressions which are pulled
out.</p></li>
<li><p><strong>opt_subs</strong> (<em>dictionary</em><em> of </em><em>expression substitutions</em>) – The expressions to be substituted before any CSE action is performed.</p></li>
<li><p><strong>order</strong> (<em>string</em><em>, </em><em>'none'</em><em> or </em><em>'canonical'</em>) – The order by which Mul and Add arguments are processed. For large
expressions where speed is a concern, use the setting order=’none’.</p></li>
<li><p><strong>ignore</strong> (<em>iterable</em><em> of </em><em>Symbols</em>) – Substitutions containing any Symbol from <code class="docutils literal notranslate"><span class="pre">ignore</span></code> will be ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.cse_opts">
<span id="modelparameters-sympy-simplify-cse-opts-module"></span><h2>modelparameters.sympy.simplify.cse_opts module<a class="headerlink" href="#module-modelparameters.sympy.simplify.cse_opts" title="Permalink to this heading">¶</a></h2>
<p>Optimizations of the expression tree representation for better CSE
opportunities.</p>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_opts.sub_post">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_opts.</span></span><span class="sig-name descname"><span class="pre">sub_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_opts.html#sub_post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_opts.sub_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace 1*-1*x with -x.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.cse_opts.sub_pre">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.cse_opts.</span></span><span class="sig-name descname"><span class="pre">sub_pre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/cse_opts.html#sub_pre"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.cse_opts.sub_pre" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace y - x with -(x - y) if -1 can be extracted from y - x.</p>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.epathtools">
<span id="modelparameters-sympy-simplify-epathtools-module"></span><h2>modelparameters.sympy.simplify.epathtools module<a class="headerlink" href="#module-modelparameters.sympy.simplify.epathtools" title="Permalink to this heading">¶</a></h2>
<p>Tools for manipulation of expressions using paths.</p>
<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.epathtools.EPath">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.epathtools.</span></span><span class="sig-name descname"><span class="pre">EPath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/epathtools.html#EPath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.epathtools.EPath" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Manipulate expressions using paths.</p>
<p>EPath grammar in EBNF notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>literal   ::= /[A-Za-z_][A-Za-z_0-9]*/
number    ::= /-?\d+/
type      ::= literal
attribute ::= literal &quot;?&quot;
all       ::= &quot;*&quot;
slice     ::= &quot;[&quot; number? (&quot;:&quot; number? (&quot;:&quot; number?)?)? &quot;]&quot;
range     ::= all | slice
query     ::= (type | attribute) (&quot;|&quot; (type | attribute))*
selector  ::= range | query range?
path      ::= &quot;/&quot; selector (&quot;/&quot; selector)*
</pre></div>
</div>
<p>See the docstring of the epath() function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.epathtools.EPath.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/epathtools.html#EPath.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.epathtools.EPath.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify parts of an expression selected by a path.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.epathtools</span> <span class="kn">import</span> <span class="n">EPath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s2">&quot;/*/[0]/Symbol&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="n">expr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[((x**2, 1), 2), ((3, y**2), z)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s2">&quot;/*/*/Symbol&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">expr</span><span class="p">)</span>
<span class="go">t + sin(2*x + 1) + cos(2*x + 2*y + E)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.epathtools.EPath.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/epathtools.html#EPath.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.epathtools.EPath.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve parts of an expression selected by a path.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.epathtools</span> <span class="kn">import</span> <span class="n">EPath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s2">&quot;/*/[0]/Symbol&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">[x, y]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">EPath</span><span class="p">(</span><span class="s2">&quot;/*/*/Symbol&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">[x, x, y]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.epathtools.epath">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.epathtools.</span></span><span class="sig-name descname"><span class="pre">epath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/epathtools.html#epath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.epathtools.epath" title="Permalink to this definition">¶</a></dt>
<dd><p>Manipulate parts of an expression selected by a path.</p>
<p>This function allows to manipulate large nested expressions in single
line of code, utilizing techniques to those applied in XML processing
standards (e.g. XPath).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">func</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.epath" title="modelparameters.sympy.simplify.epathtools.epath"><code class="xref py py-func docutils literal notranslate"><span class="pre">epath()</span></code></a> retrieves elements selected by
the <code class="docutils literal notranslate"><span class="pre">path</span></code>. Otherwise it applies <code class="docutils literal notranslate"><span class="pre">func</span></code> to each matching element.</p>
<p>Note that it is more efficient to create an EPath object and use the select
and apply methods of that object, since this will compile the path string
only once.  This function should only be used as a convenient shortcut for
interactive use.</p>
<p>This is the supported syntax:</p>
<ul class="simple">
<li><dl class="simple">
<dt>select all: <code class="docutils literal notranslate"><span class="pre">/*</span></code></dt><dd><p>Equivalent of <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">arg</span> <span class="pre">in</span> <span class="pre">args:</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select slice: <code class="docutils literal notranslate"><span class="pre">/[0]</span></code> or <code class="docutils literal notranslate"><span class="pre">/[1:5]</span></code> or <code class="docutils literal notranslate"><span class="pre">/[1:5:2]</span></code></dt><dd><p>Supports standard Python’s slice syntax.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select by type: <code class="docutils literal notranslate"><span class="pre">/list</span></code> or <code class="docutils literal notranslate"><span class="pre">/list|tuple</span></code></dt><dd><p>Emulates <a class="reference external" href="https://docs.python.org/3/library/functions.html#isinstance" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">isinstance()</span></code></a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>select by attribute: <code class="docutils literal notranslate"><span class="pre">/__iter__?</span></code></dt><dd><p>Emulates <a class="reference external" href="https://docs.python.org/3/library/functions.html#hasattr" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">hasattr()</span></code></a>.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.EPath" title="modelparameters.sympy.simplify.epathtools.EPath"><em>EPath</em></a>) – A path as a string or a compiled EPath.</p></li>
<li><p><strong>expr</strong> (<a class="reference internal" href="modelparameters.sympy.core.html#modelparameters.sympy.core.basic.Basic" title="modelparameters.sympy.core.basic.Basic"><em>Basic</em></a><em> | </em><em>iterable</em>) – An expression or a container of expressions.</p></li>
<li><p><strong>func</strong> (<em>callable</em><em> (</em><em>optional</em><em>)</em>) – A callable that will be applied to matching parts.</p></li>
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em> (</em><em>optional</em><em>)</em>) – Additional positional arguments to <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – Additional keyword arguments to <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.epathtools</span> <span class="kn">import</span> <span class="n">epath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">E</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/*/[0]/Symbol&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span><span class="p">)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="go">[x, y]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="n">expr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[((x**2, 1), 2), ((3, y**2), z)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/*/*/Symbol&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="go">[x, x, y]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">expr</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">expr</span><span class="p">)</span>
<span class="go">t + sin(2*x + 1) + cos(2*x + 2*y + E)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.fu">
<span id="modelparameters-sympy-simplify-fu-module"></span><h2>modelparameters.sympy.simplify.fu module<a class="headerlink" href="#module-modelparameters.sympy.simplify.fu" title="Permalink to this heading">¶</a></h2>
<p>Implementation of the trigsimp algorithm by Fu et al.</p>
<p>The idea behind the <code class="docutils literal notranslate"><span class="pre">fu</span></code> algorithm is to use a sequence of rules, applied
in what is heuristically known to be a smart order, to select a simpler
expression that is equivalent to the input.</p>
<p>There are transform rules in which a single rule is applied to the
expression tree. The following are just mnemonic in nature; see the
docstrings for examples.</p>
<blockquote>
<div><p>TR0 - simplify expression
TR1 - sec-csc to cos-sin
TR2 - tan-cot to sin-cos ratio
TR2i - sin-cos ratio to tan
TR3 - angle canonicalization
TR4 - functions at special angles
TR5 - powers of sin to powers of cos
TR6 - powers of cos to powers of sin
TR7 - reduce cos power (increase angle)
TR8 - expand products of sin-cos to sums
TR9 - contract sums of sin-cos to products
TR10 - separate sin-cos arguments
TR10i - collect sin-cos arguments
TR11 - reduce double angles
TR12 - separate tan arguments
TR12i - collect tan arguments
TR13 - expand product of tan-cot
TRmorrie - prod(cos(x*2**i), (i, 0, k - 1)) -&gt; sin(2**k*x)/(2**k*sin(x))
TR14 - factored powers of sin or cos to cos or sin power
TR15 - negative powers of sin to cot power
TR16 - negative powers of cos to tan power
TR22 - tan-cot powers to negative powers of sec-csc functions
TR111 - negative sin-cos-tan powers to csc-sec-cot</p>
</div></blockquote>
<p>There are 4 combination transforms (CTR1 - CTR4) in which a sequence of
transformations are applied and the simplest expression is selected from
a few options.</p>
<p>Finally, there are the 2 rule lists (RL1 and RL2), which apply a
sequence of transformations and combined transformations, and the <code class="docutils literal notranslate"><span class="pre">fu</span></code>
algorithm itself, which applies rules and rule lists and selects the
best expressions. There is also a function <code class="docutils literal notranslate"><span class="pre">L</span></code> which counts the number
of trigonometric functions that appear in the expression.</p>
<p>Other than TR0, re-writing of expressions is not done by the transformations.
e.g. TR10i finds pairs of terms in a sum that are in the form like
<code class="docutils literal notranslate"><span class="pre">cos(x)*cos(y)</span> <span class="pre">+</span> <span class="pre">sin(x)*sin(y)</span></code>. Such expression are targeted in a bottom-up
traversal of the expression, but no manipulation to make them appear is
attempted. For example,</p>
<blockquote>
<div><p>Set-up for examples below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">fu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">TR9</span><span class="p">,</span> <span class="n">TR10i</span><span class="p">,</span> <span class="n">TR11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">factor</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">powsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
</pre></div>
</div>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">-sin(x)*sin(y)/cos(x) + cos(y)</span>
</pre></div>
</div>
<p>If the expression is put in “normal” form (with a common denominator) then
the transformation is successful:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span>
<span class="go">cos(x + y)/cos(x)</span>
</pre></div>
</div>
<p>TR11’s behavior is similar. It rewrites double angles as smaller angles but
doesn’t do any simplification of the result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(2*sin(1)*cos(1))**a*cos(1)**(-a)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">(2*sin(1))**a</span>
</pre></div>
</div>
<p>The temptation is to try make these TR rules “smarter” but that should really
be done at a higher level; the TR rules should try maintain the “do one thing
well” principle.  There is one exception, however. In TR10i and TR9 terms are
recognized even when they are each multiplied by a common factor:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="go">a*cos(x - y)</span>
</pre></div>
</div>
<p>Factoring with <code class="docutils literal notranslate"><span class="pre">factor_terms</span></code> is used but it it “JIT”-like, being delayed
until it is deemed necessary. Furthermore, if the factoring does not
help with the simplification, it is not retained, so
<code class="docutils literal notranslate"><span class="pre">a*cos(x)*cos(y)</span> <span class="pre">+</span> <span class="pre">a*sin(x)*sin(z)</span></code> does not become the factored
(but unsimplified in the trigonometric sense) expression:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">a*sin(x)*sin(z) + a*cos(x)*cos(y)</span>
</pre></div>
</div>
<p>In some cases factoring might be a good idea, but the user is left
to make that decision. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">=</span><span class="p">((</span><span class="mi">15</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="mi">25</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="mi">14</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span>
<span class="gp">... </span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">18</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
<p>In the expanded state, there are nearly 1000 trig functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">932</span>
</pre></div>
</div>
<p>If the expression where factored first, this would take time but the
resulting expression would be transformed very quickly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">clock</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">();</span> <span class="n">f</span><span class="p">();</span> <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">factor</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>  
<span class="go">0.86</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>  
<span class="go">0.016</span>
</pre></div>
</div>
<p>If the unexpanded expression is used, the transformation takes longer but
not as long as it took to factor it and then transform it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  
<span class="go">0.28</span>
</pre></div>
</div>
<p>So neither expansion nor factoring is used in <code class="docutils literal notranslate"><span class="pre">TR10i</span></code>: if the
expression is already factored (or partially factored) then expansion
with <code class="docutils literal notranslate"><span class="pre">trig=True</span></code> would destroy what is already known and take
longer; if the expression is expanded, factoring may take longer than
simply applying the transformation itself.</p>
<p>Although the algorithms should be canonical, always giving the same
result, they may not yield the best result. This, in general, is
the nature of simplification where searching all possible transformation
paths is very expensive. Here is a simple example. There are 6 terms
in the following sum:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</pre></div>
</div>
<p>Serendipitously, fu gives the best result:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">3*cos(y - z)/2 - cos(2*x + y + z)/2</span>
</pre></div>
</div>
<p>But if different terms were combined, a less-optimal result might be
obtained, requiring some additional work to get better simplification,
but still less than optimal. The following shows an alternative form
of <code class="docutils literal notranslate"><span class="pre">expr</span></code> that resists optimal simplification once a given step
is taken since it leads to a dead end:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
<span class="gp">... </span>    <span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">sin(2*x)*sin(y + z)/2 - cos(x)**2*cos(y + z) + 3*cos(y - z)/2 + cos(y + z)/2</span>
</pre></div>
</div>
<p>Here is a smaller expression that exhibits the same behavior:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">sin(x)*sin(y + z)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newa</span> <span class="o">=</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># this combines two more of the remaining terms</span>
<span class="go">sin(x)**2*cos(y)*cos(z) + sin(y)*sin(z)*cos(x)**2 + cos(y - z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">_</span> <span class="o">+</span> <span class="n">newa</span><span class="p">)</span> <span class="o">==</span> <span class="n">_</span> <span class="o">+</span> <span class="n">newa</span>  <span class="c1"># but now there is no more simplification</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Without getting lucky or trying all possible pairings of arguments, the
final result may be less than optimal and impossible to find without
better heuristics or brute force trial of all possibilities.</p>
<p class="rubric">Notes</p>
<p>This work was started by Dimitar Vlahovski at the Technological School
“Electronic systems” (30.11.2011).</p>
<p class="rubric">References</p>
<p>Fu, Hongguang, Xiuqin Zhong, and Zhenbing Zeng. “Automated and readable
simplification of trigonometric expressions.” Mathematical and computer
modelling 44.11 (2006): 1169-1177.
<a class="reference external" href="http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/DESTIME2006/DES_contribs/Fu/simplification.pdf">http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/DESTIME2006/DES_contribs/Fu/simplification.pdf</a></p>
<p><a class="reference external" href="http://www.sosmath.com/trig/Trig5/trig5/pdf/pdf.html">http://www.sosmath.com/trig/Trig5/trig5/pdf/pdf.html</a> gives a formula sheet.</p>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.L">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Return count of trigonometric functions in expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">L</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR0">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR0" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplification of rational polynomials, trying to simplify
the expression, e.g. combine things like 3*x + 2*x, etc….</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR1">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR1" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace sec, csc with 1/cos, 1/sin</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR1</span><span class="p">,</span> <span class="n">sec</span><span class="p">,</span> <span class="n">csc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">csc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">1/cos(x) + 2/sin(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR10">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR10" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate sums in <code class="docutils literal notranslate"><span class="pre">cos</span></code> and <code class="docutils literal notranslate"><span class="pre">sin</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
<span class="go">-sin(a)*sin(b) + cos(a)*cos(b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
<span class="go">sin(a)*cos(b) + sin(b)*cos(a)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span>
<span class="go">(-sin(a)*sin(b) + cos(a)*cos(b))*sin(c) +     (sin(a)*cos(b) + sin(b)*cos(a))*cos(c)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR10i">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR10i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR10i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR10i" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of products to function of sum.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR10i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(3) + sin(4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*sqrt(2)*x*sin(x + pi/6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR11">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR11</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR11"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR11" title="Permalink to this definition">¶</a></dt>
<dd><p>Function of double angle to product. The <code class="docutils literal notranslate"><span class="pre">base</span></code> argument can be used
to indicate what is the un-doubled argument, e.g. if 3*pi/7 is the base
then cosine and sine functions with argument 6*pi/7 will be replaced.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sin(x)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">-sin(x)**2 + cos(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">4*(-sin(x)**2 + cos(x)**2)*sin(x)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">4*(-sin(x/3)**2 + cos(x/3)**2)*sin(x/3)*cos(x/3)</span>
</pre></div>
</div>
<p>If the arguments are simply integers, no change is made
unless a base is provided:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-sin(2)**2 + cos(2)**2</span>
</pre></div>
</div>
<p>There is a subtle issue here in that autosimplification will convert
some higher angles to lower angles</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-cos(pi/7) + cos(3*pi/7)</span>
</pre></div>
</div>
<p>The 6*pi/7 angle is now pi/7 but can be targeted with TR11 by supplying
the 3*pi/7 base:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-sin(3*pi/7)**2 + cos(3*pi/7)**2 + cos(3*pi/7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR111">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR111</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR111"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR111" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert f(x)**-i to g(x)**i where either <code class="docutils literal notranslate"><span class="pre">i</span></code> is an integer
or the base is positive and f, g are: tan, cot; sin, csc; or cos, sec.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR111</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR111</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-cot(x)**2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR12">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR12" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate sums in <code class="docutils literal notranslate"><span class="pre">tan</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
<span class="go">(tan(x) + tan(y))/(-tan(x)*tan(y) + 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR12i">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR12i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR12i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR12i" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine tan arguments as
(tan(y) + tan(x))/(tan(x)*tan(y) - 1) -&gt; -tan(x + y)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR12i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="n">tc</span> <span class="o">=</span> <span class="p">[</span><span class="n">tan</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="o">-</span><span class="n">ta</span> <span class="o">-</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">ta</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
<span class="go">-3*tan(a + b)*tan(a + c)/(2*(tan(a) + tan(b) - 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR13">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR13</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR13"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR13" title="Permalink to this definition">¶</a></dt>
<dd><p>Change products of <code class="docutils literal notranslate"><span class="pre">tan</span></code> or <code class="docutils literal notranslate"><span class="pre">cot</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR13</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">-tan(2)/tan(5) - tan(3)/tan(5) + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR13</span><span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cot</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cot(2)*cot(5) + 1 + cot(3)*cot(5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR14">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR14</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR14"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR14" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert factored powers of sin and cos identities into simpler
expressions.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-sin(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">((</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-cos(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="n">p2</span><span class="o">*</span><span class="n">p3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-18*(x - 1)*sin(x)**2*sin(y)**4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR15">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR15</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR15"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR15" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert sin(x)*-2 to 1 + cot(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR15</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-cot(x)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR16">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR16" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert cos(x)*-2 to 1 + tan(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR16</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-tan(x)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR2">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR2" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace tan and cot with sin/cos and cos/sin</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">sin(x)/cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">cos(x)/sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR22">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR22</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR22"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR22" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert tan(x)**2 to sec(x)**2 - 1 and cot(x)**2 to csc(x)**2 - 1.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR22</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR22</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sec(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR22</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">csc(x)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR2i">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR2i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR2i" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Converts ratios involving sin and cos as follows::</dt><dd><p>sin(x)/cos(x) -&gt; tan(x)
sin(x)/(cos(x) + 1) -&gt; tan(x/2) if half=True</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR2i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">tan(x)</span>
</pre></div>
</div>
<p>Powers of the numerator and denominator are also recognized</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">tan(x/2)**2</span>
</pre></div>
</div>
<p>The transformation does not take place unless assumptions allow
(i.e. the base must be positive or the exponent must be an integer
for both numerator and denominator)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>
<span class="go">(cos(x) + 1)**(-a)*sin(x)**a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR3">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR3" title="Permalink to this definition">¶</a></dt>
<dd><p>Induced formula: example sin(-a) = -sin(a)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)))</span>
<span class="go">cos(x*(x - y) + y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-cos(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR4">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR4" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify values of special angles.</p>
<blockquote>
<div><p>a=  0   pi/6        pi/4        pi/3        pi/2</p>
</div></blockquote>
<p>tan(a)  0   sqt(3)/3    1           sqrt(3)     –</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">tan</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">cot</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="go">1 0 0 zoo</span>
<span class="go">sqrt(3)/2 1/2 sqrt(3)/3 sqrt(3)</span>
<span class="go">sqrt(2)/2 sqrt(2)/2 1 1</span>
<span class="go">1/2 sqrt(3)/2 sqrt(3) sqrt(3)/3</span>
<span class="go">0 1 zoo 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR5">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR5" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement of sin**2 with 1 - cos(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-cos(x)**2 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># unchanged</span>
<span class="go">sin(x)**(-2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(-cos(x)**2 + 1)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR6">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR6"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR6" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement of cos**2 with 1 - sin(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-sin(x)**2 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#unchanged</span>
<span class="go">cos(x)**(-2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(-sin(x)**2 + 1)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR7">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR7</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR7"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR7" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowering the degree of cos(x)**2</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR7</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cos(2*x)/2 + 1/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR7</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">cos(2*x)/2 + 3/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR8">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR8" title="Permalink to this definition">¶</a></dt>
<dd><p>Converting products of <code class="docutils literal notranslate"><span class="pre">cos</span></code> and/or <code class="docutils literal notranslate"><span class="pre">sin</span></code> to a sum or
difference of <code class="docutils literal notranslate"><span class="pre">cos</span></code> and or <code class="docutils literal notranslate"><span class="pre">sin</span></code> terms.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR8</span><span class="p">,</span> <span class="n">TR7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(5)/2 + cos(1)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">sin(5)/2 + sin(1)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-cos(5)/2 + cos(1)/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TR9">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR9</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TR9"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TR9" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of <code class="docutils literal notranslate"><span class="pre">cos</span></code> or <code class="docutils literal notranslate"><span class="pre">sin</span></code> terms as a product of <code class="docutils literal notranslate"><span class="pre">cos</span></code> or <code class="docutils literal notranslate"><span class="pre">sin</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TR9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">2*cos(1/2)*cos(3/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(1) + 4*sin(3/2)*cos(1/2)</span>
</pre></div>
</div>
<p>If no change is made by TR9, no re-arrangement of the
expression will be made. For example, though factoring
of common term is attempted, if the factored expression
wasn’t changed, the original expression will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(3) + cos(2)*cos(3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.TRmorrie">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TRmorrie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#TRmorrie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.TRmorrie" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cos(x)*cos(2*x)*…*cos(2**(k-1)*x) -&gt; sin(2**k*x)/(2**k*sin(x))</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">TRmorrie</span><span class="p">,</span> <span class="n">TR8</span><span class="p">,</span> <span class="n">TR3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">sin(4*x)/(4*sin(x))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]))</span>
<span class="go">7*sin(12)*sin(16)*cos(5)*cos(7)*cos(9)/(64*sin(1)*sin(3))</span>
</pre></div>
</div>
<p>Sometimes autosimplification will cause a power to be
not recognized. e.g. in the following, cos(4*pi/7) automatically
simplifies to -cos(3*pi/7) so only 2 of the 3 terms are
recognized:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">))</span>
<span class="go">-sin(3*pi/7)*cos(3*pi/7)/(4*sin(pi/7))</span>
</pre></div>
</div>
<p>A touch by TR8 resolves the expression to a Rational</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">-1/8</span>
</pre></div>
</div>
<p>In this case, if eq is unsimplified, the answer is obtained
directly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>But if angles are made canonical with TR3 then the answer
is not simplified without further work:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">sin(pi/18)*cos(pi/9)*cos(2*pi/9)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">sin(pi/18)*sin(4*pi/9)/(8*sin(pi/9))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">cos(7*pi/18)/(16*sin(pi/9))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>The original expression would have resolve to 1/16 directly with TR8,
however:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Morrie%27s_law">http://en.wikipedia.org/wiki/Morrie%27s_law</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.as_f_sign_1">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">as_f_sign_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#as_f_sign_1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.as_f_sign_1" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">e</span></code> is a sum that can be written as <code class="docutils literal notranslate"><span class="pre">g*(a</span> <span class="pre">+</span> <span class="pre">s)</span></code> where
<code class="docutils literal notranslate"><span class="pre">s</span></code> is <code class="docutils literal notranslate"><span class="pre">+/-1</span></code>, return <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, and <code class="docutils literal notranslate"><span class="pre">s</span></code> where <code class="docutils literal notranslate"><span class="pre">a</span></code> does
not have a leading negative coefficient.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">as_f_sign_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_f_sign_1</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(1, x, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_f_sign_1</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(1, x, -1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_f_sign_1</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(-1, x, -1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_f_sign_1</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(-1, x, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_f_sign_1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(2, x, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.fu">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">fu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#fu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.fu" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to simplify expression by using transformation rules given
in the algorithm by Fu et al.</p>
<p><a class="reference internal" href="#modelparameters.sympy.simplify.fu.fu" title="modelparameters.sympy.simplify.fu.fu"><code class="xref py py-func docutils literal notranslate"><span class="pre">fu()</span></code></a> will try to minimize the objective function <code class="docutils literal notranslate"><span class="pre">measure</span></code>.
By default this first minimizes the number of trig terms and then minimizes
the number of total operations.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">fu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
<span class="go">3/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sqrt(2)*sin(x + pi/3)</span>
</pre></div>
</div>
<p>CTR1 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">cos(x)**4 - 2*cos(y)**2 + 2</span>
</pre></div>
</div>
<p>CTR2 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x)**2</span>
</pre></div>
</div>
<p>CTR3 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
<span class="go">sqrt(2)*sin(a + b + pi/4)</span>
</pre></div>
</div>
<p>CTR4 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x + pi/3)</span>
</pre></div>
</div>
<p>Example 1</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-cos(x)**2 + cos(y)**2</span>
</pre></div>
</div>
<p>Example 2</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">sin(pi/18)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>Example 3</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">+</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">))</span>
<span class="go">-sqrt(3)</span>
</pre></div>
</div>
<p>Objective function example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># default objective function</span>
<span class="go">tan(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">measure</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span> <span class="c1"># maximize op count</span>
<span class="go">sin(x)/cos(x)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/">http://rfdz.ph-noe.ac.at/fileadmin/Mathematik_Uploads/ACDCA/</a>
DESTIME2006/DES_contribs/Fu/simplification.pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.hyper_as_trig">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">hyper_as_trig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#hyper_as_trig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.hyper_as_trig" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an expression containing hyperbolic functions in terms
of trigonometric functions. Any trigonometric functions initially
present are replaced with Dummy symbols and the function to undo
the masking and the conversion back to hyperbolics is also returned. It
should always be true that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">hyper_as_trig</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">==</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">hyper_as_trig</span><span class="p">,</span> <span class="n">fu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">sinh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">hyper_as_trig</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">fu</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="go">cosh(2*x)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Hyperbolic_function">http://en.wikipedia.org/wiki/Hyperbolic_function</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.process_common_addends">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">process_common_addends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#process_common_addends"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.process_common_addends" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <code class="docutils literal notranslate"><span class="pre">do</span></code> to addends of <code class="docutils literal notranslate"><span class="pre">rv</span></code> that (if key1=True) share at least
a common absolute value of their coefficient and the value of <code class="docutils literal notranslate"><span class="pre">key2</span></code> when
applied to the argument. If <code class="docutils literal notranslate"><span class="pre">key1</span></code> is False <code class="docutils literal notranslate"><span class="pre">key2</span></code> must be supplied and
will be the only key applied.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.fu.trig_split">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">trig_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/fu.html#trig_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.fu.trig_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gcd, s1, s2, a1, a2, bool where</p>
<dl class="simple">
<dt>If two is False (default) then::</dt><dd><p>a + b = gcd*(s1*f(a1) + s2*f(a2)) where f = cos if bool else sin</p>
</dd>
<dt>else:</dt><dd><dl class="simple">
<dt>if bool, a + b was +/- cos(a1)*cos(a2) +/- sin(a1)*sin(a2) and equals</dt><dd><p>n1*gcd*cos(a - b) if n1 == n2 else
n1*gcd*cos(a + b)</p>
</dd>
<dt>else a + b was +/- cos(a1)*sin(a2) +/- sin(a1)*cos(a2) and equals</dt><dd><p>n1*gcd*sin(a + b) if n1 = n2 else
n1*gcd*sin(b - a)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.fu</span> <span class="kn">import</span> <span class="n">trig_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="go">(1, 1, 1, x, y, True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="go">(2, 1, -1, x, y, True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="go">(sin(y), 1, 1, x, y, True)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2, 1, -1, x, pi/6, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(sqrt(2), 1, 1, x, pi/4, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(sqrt(2), 1, -1, x, pi/4, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2*sqrt(2), 1, -1, x, pi/6, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-2*sqrt(2), 1, 1, x, pi/3, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(sqrt(6)/3, 1, 1, x, pi/6, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-2*sqrt(2)*sin(y), 1, 1, x, pi/3, False)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trig_split</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">two</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.hyperexpand">
<span id="modelparameters-sympy-simplify-hyperexpand-module"></span><h2>modelparameters.sympy.simplify.hyperexpand module<a class="headerlink" href="#module-modelparameters.sympy.simplify.hyperexpand" title="Permalink to this heading">¶</a></h2>
<p>Expand Hypergeometric (and Meijer G) functions into named
special functions.</p>
<p>The algorithm for doing this uses a collection of lookup tables of
hypergeometric functions, and various of their properties, to expand
many hypergeometric functions in terms of special functions.</p>
<dl class="simple">
<dt>It is based on the following paper:</dt><dd><p>Kelly B. Roach.  Meijer G Function Representations.
In: Proceedings of the 1997 International Symposium on Symbolic and
Algebraic Computation, pages 205-211, New York, 1997. ACM.</p>
</dd>
</dl>
<p>It is described in great(er) detail in the Sphinx documentation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Formula">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">Formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Formula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class represents hypergeometric formulae.</p>
<p>Its data members are:
- z, the argument
- closed_form, the closed form expression
- symbols, the free symbols (parameters) in the formula
- func, the function
- B, C, M (see _compute_basis)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">Formula</span><span class="p">,</span> <span class="n">Hyper_Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">Hyper_Function</span><span class="p">((</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Formula</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Formula.closed_form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">closed_form</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Formula.closed_form" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Formula.find_instantiations">
<span class="sig-name descname"><span class="pre">find_instantiations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Formula.find_instantiations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Formula.find_instantiations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find substitutions of the free symbols that match <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p>
<p>Return the substitution dictionaries as a list. Note that the returned
instantiations need not actually match, or be valid!</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.FormulaCollection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">FormulaCollection</span></span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#FormulaCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.FormulaCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A collection of formulae to use as origins.</p>
<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.FormulaCollection.lookup_origin">
<span class="sig-name descname"><span class="pre">lookup_origin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#FormulaCollection.lookup_origin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.FormulaCollection.lookup_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the suitable target <code class="docutils literal notranslate"><span class="pre">func</span></code>, try to find an origin in our
knowledge base.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="p">(</span><span class="n">FormulaCollection</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Hyper_Function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">FormulaCollection</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">lookup_origin</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((),</span> <span class="p">()))</span><span class="o">.</span><span class="n">closed_form</span>
<span class="go">exp(_z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">lookup_origin</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">()))</span><span class="o">.</span><span class="n">closed_form</span>
<span class="go">HyperRep_power1(-1, _z)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Hyper_Function</span><span class="p">([</span><span class="n">S</span><span class="p">(</span><span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;3/4 + 4&#39;</span><span class="p">)],</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">lookup_origin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">closed_form</span>
<span class="go">HyperRep_sqrts1(-1/4, _z)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.G_Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">G_Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#G_Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.G_Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="modelparameters.sympy.core.html#modelparameters.sympy.core.expr.Expr" title="modelparameters.sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<p>A Meijer G-function.</p>
<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.G_Function.args">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of arguments of ‘self’.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
<span class="go">(x,)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">x</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
<span class="go">(x, y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">y</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Never use self._args, always use self.args.
Only use _args in __new__ when creating a new function.
Don’t override .args() from Basic (so that it’s easy to
change the interface in the future if needed).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.G_Function.compute_buckets">
<span class="sig-name descname"><span class="pre">compute_buckets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#G_Function.compute_buckets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.compute_buckets" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute buckets for the fours sets of parameters.</p>
<p>We guarantee that any two equal Mod objects returned are actually the
same, and that the buckets are sorted by real part (an and bq
descendending, bm and ap ascending).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">G_Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">symbols</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G_Function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">compute_buckets</span><span class="p">()</span>
<span class="go">({0: [3, 2, 1], 1/2: [3/2]},</span>
<span class="go">{0: [2], y: [y, y + 1, y + 3]}, {0: [2]}, {y: [y]})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.G_Function.default_assumptions">
<span class="sig-name descname"><span class="pre">default_assumptions</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.default_assumptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.G_Function.signature">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">signature</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.signature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">Hyper_Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Hyper_Function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="modelparameters.sympy.core.html#modelparameters.sympy.core.expr.Expr" title="modelparameters.sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<p>A generalized hypergeometric function.</p>
<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.args">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of arguments of ‘self’.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
<span class="go">(x,)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">x</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
<span class="go">(x, y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">y</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Never use self._args, always use self.args.
Only use _args in __new__ when creating a new function.
Don’t override .args() from Basic (so that it’s easy to
change the interface in the future if needed).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.build_invariants">
<span class="sig-name descname"><span class="pre">build_invariants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Hyper_Function.build_invariants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.build_invariants" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the invariant vector.</p>
<dl class="simple">
<dt>The invariant vector is:</dt><dd><p>(gamma, ((s1, n1), …, (sk, nk)), ((t1, m1), …, (tr, mr)))</p>
</dd>
<dt>where gamma is the number of integer a &lt; 0,</dt><dd><p>s1 &lt; … &lt; sk
nl is the number of parameters a_i congruent to sl mod 1
t1 &lt; … &lt; tr
ml is the number of parameters b_i congruent to tl mod 1</p>
</dd>
</dl>
<p>If the index pair contains parameters, then this is not truly an
invariant, since the parameters cannot be sorted uniquely mod1.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">Hyper_Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ap</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Here gamma = 1,</dt><dd><dl class="simple">
<dt>k = 3, s1 = 0, s2 = 1/3, s3 = 1/2</dt><dd><p>n1 = 1, n2 = 1,   n2 = 2</p>
</dd>
<dt>r = 1, t1 = 0</dt><dd><p>m1 = 2:</p>
</dd>
</dl>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Hyper_Function</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">bq</span><span class="p">)</span><span class="o">.</span><span class="n">build_invariants</span><span class="p">()</span>
<span class="go">(1, ((0, 1), (1/3, 1), (1/2, 2)), ((0, 2),))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.default_assumptions">
<span class="sig-name descname"><span class="pre">default_assumptions</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.default_assumptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.difficulty">
<span class="sig-name descname"><span class="pre">difficulty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Hyper_Function.difficulty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.difficulty" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate how many steps it takes to reach <code class="docutils literal notranslate"><span class="pre">func</span></code> from self.
Return -1 if impossible.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.gamma">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of upper parameters that are negative integers</p>
<p>This is a transformation invariant.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Hyper_Function.sizes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sizes</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.sizes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerFormula">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerFormula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matcher</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerFormula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class represents a Meijer G-function formula.</p>
<p>Its data members are:
- z, the argument
- symbols, the free symbols (parameters) in the formula
- func, the function
- B, C, M (c/f ordinary Formula)</p>
<dl class="py property">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerFormula.closed_form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">closed_form</span></span><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula.closed_form" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerFormula.try_instantiate">
<span class="sig-name descname"><span class="pre">try_instantiate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerFormula.try_instantiate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula.try_instantiate" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to instantiate the current formula to (almost) match func.
This uses the _matcher passed on init.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerFormulaCollection</span></span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerFormulaCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class holds a collection of meijer g formulae.</p>
<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection.lookup_origin">
<span class="sig-name descname"><span class="pre">lookup_origin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerFormulaCollection.lookup_origin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection.lookup_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to find a formula that matches func.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerShiftA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerShiftA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerShiftA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment an upper b index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerShiftB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerShiftB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerShiftB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement an upper a index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerShiftC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerShiftC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerShiftC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment a lower b index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerShiftD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerShiftD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerShiftD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement a lower a index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerUnShiftA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerUnShiftA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement an upper b index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerUnShiftB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerUnShiftB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment an upper a index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerUnShiftC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerUnShiftC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement a lower b index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MeijerUnShiftD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MeijerUnShiftD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment a lower a index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.MultOperator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">MultOperator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#MultOperator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.MultOperator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Simply multiply by a “constant”</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Operator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">Operator</span></span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for operators to be applied to our functions.</p>
<p>These operators are differential operators. They are by convention
expressed in the variable D = z*d/dz (although this base class does
not actually care).
Note that when the operator is applied to an object, we typically do
<em>not</em> blindly differentiate but instead use a different representation
of the z*d/dz operator (see make_derivative_operator).</p>
<p>To subclass from this, define a __init__ method that initalises a
self._poly variable. This variable stores a polynomial. By convention
the generator is z*d/dz, and acts to the right of all coefficients.</p>
<dl class="simple">
<dt>Thus this poly</dt><dd><p>x**2 + 2*z*x + 1</p>
</dd>
<dt>represents the differential operator</dt><dd><p>(z*d/dz)**2 + 2*z**2*d/dz.</p>
</dd>
</dl>
<p>This class is used only in the implementation of the hypergeometric
function expansion algorithm.</p>
<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.Operator.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#Operator.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.Operator.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <code class="docutils literal notranslate"><span class="pre">self</span></code> to the object <code class="docutils literal notranslate"><span class="pre">obj</span></code>, where the generator is <code class="docutils literal notranslate"><span class="pre">op</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">Operator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..polys.polytools</span> <span class="kn">import</span> <span class="n">Poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span><span class="o">.</span><span class="n">_poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">y*z**7 + 7*z**7 + 42*z**5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.ReduceOrder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">ReduceOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ai</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#ReduceOrder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Reduce Order by cancelling an upper and a lower index.</p>
<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_minus">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">meijer_minus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#ReduceOrder.meijer_minus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_minus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_plus">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">meijer_plus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#ReduceOrder.meijer_plus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_plus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.ShiftA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">ShiftA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ai</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#ShiftA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.ShiftA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment an upper index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.ShiftB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">ShiftB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#ShiftB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.ShiftB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement a lower index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.UnShiftA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">UnShiftA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#UnShiftA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.UnShiftA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Decrement an upper index.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.UnShiftB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">UnShiftB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#UnShiftB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.UnShiftB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator" title="modelparameters.sympy.simplify.hyperexpand.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a></p>
<p>Increment a lower index.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.add_formulae">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">add_formulae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formulae</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#add_formulae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.add_formulae" title="Permalink to this definition">¶</a></dt>
<dd><p>Create our knowledge base.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.add_meijerg_formulae">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">add_meijerg_formulae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formulae</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#add_meijerg_formulae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.add_meijerg_formulae" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.apply_operators">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">apply_operators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#apply_operators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.apply_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the list of operators <code class="docutils literal notranslate"><span class="pre">ops</span></code> to object <code class="docutils literal notranslate"><span class="pre">obj</span></code>, substituting
<code class="docutils literal notranslate"><span class="pre">op</span></code> for the generator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.build_hypergeometric_formula">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">build_hypergeometric_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#build_hypergeometric_formula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.build_hypergeometric_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a formula object representing the hypergeometric function <code class="docutils literal notranslate"><span class="pre">func</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.debug">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.devise_plan">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">devise_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#devise_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.devise_plan" title="Permalink to this definition">¶</a></dt>
<dd><p>Devise a plan (consisting of shift and un-shift operators) to be applied
to the hypergeometric function <code class="docutils literal notranslate"><span class="pre">target</span></code> to yield <code class="docutils literal notranslate"><span class="pre">origin</span></code>.
Returns a list of operators.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">devise_plan</span><span class="p">,</span> <span class="n">Hyper_Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">z</span>
</pre></div>
</div>
<p>Nothing to do:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">()),</span> <span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">()),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">Hyper_Function</span><span class="p">((),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Very simple plans:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="p">()),</span> <span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="p">()),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper 1.&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)),</span> <span class="n">Hyper_Function</span><span class="p">((),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment lower index #0 of [], [1].&gt;]</span>
</pre></div>
</div>
<p>Several buckets:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">),</span> <span class="p">()),</span>
<span class="gp">... </span>            <span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;3/2&#39;</span><span class="p">)),</span> <span class="p">()),</span> <span class="n">z</span><span class="p">)</span> 
<span class="go">[&lt;Decrement upper index #0 of [3/2, 1], [].&gt;,</span>
<span class="go">&lt;Decrement upper index #0 of [2, 3/2], [].&gt;]</span>
</pre></div>
</div>
<p>A slightly more complicated plan:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">()),</span> <span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">()),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper 2.&gt;, &lt;Decrement upper index #0 of [2, 2], [].&gt;]</span>
</pre></div>
</div>
<p>Another more complicated plan: (note that the ap have to be shifted first!)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)),</span> <span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Decrement lower 3.&gt;, &lt;Decrement lower 4.&gt;,</span>
<span class="go">&lt;Decrement upper index #1 of [-1, 2], [4].&gt;,</span>
<span class="go">&lt;Decrement upper index #1 of [-1, 3], [4].&gt;, &lt;Increment upper -2.&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.devise_plan_meijer">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">devise_plan_meijer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#devise_plan_meijer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.devise_plan_meijer" title="Permalink to this definition">¶</a></dt>
<dd><p>Find operators to convert G-function <code class="docutils literal notranslate"><span class="pre">fro</span></code> into G-function <code class="docutils literal notranslate"><span class="pre">to</span></code>.</p>
<p>It is assumed that fro and to have the same signatures, and that in fact
any corresponding pair of parameters differs by integers, and a direct path
is possible. I.e. if there are parameters a1 b1 c1  and a2 b2 c2 it is
assumed that a1 can be shifted to a2, etc. The only thing this routine
determines is the order of shifts to apply, nothing clever will be tried.
It is also assumed that fro is suitable.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="p">(</span><span class="n">devise_plan_meijer</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">G_Function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">z</span>
</pre></div>
</div>
<p>Empty plan:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Very simple plans:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper a index #0 of [0], [], [], [].&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Decrement upper a=0.&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment lower a index #0 of [], [1], [], [].&gt;]</span>
</pre></div>
</div>
<p>Slightly more complicated plans:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper a index #0 of [1], [], [], [].&gt;,</span>
<span class="go">&lt;Increment upper a index #0 of [0], [], [], [].&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper b=0.&gt;, &lt;Decrement upper a=0.&gt;]</span>
</pre></div>
</div>
<p>Order matters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">devise_plan_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]),</span>
<span class="gp">... </span>                   <span class="n">G_Function</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[]),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[&lt;Increment upper a index #0 of [0], [], [1], [].&gt;, &lt;Increment upper b=0.&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.hyperexpand">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">hyperexpand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_hyper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#hyperexpand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.hyperexpand" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand hypergeometric functions. If allow_hyper is True, allow partial
simplification (that is a result different from input,
but still containing hypergeometric functions).</p>
<p>If a G-function has expansions both at zero and at infinity,
<code class="docutils literal notranslate"><span class="pre">place</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">zoo</span></code> to indicate the
preferred choice.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">hyperexpand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..functions</span> <span class="kn">import</span> <span class="n">hyper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyperexpand</span><span class="p">(</span><span class="n">hyper</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">z</span><span class="p">))</span>
<span class="go">exp(z)</span>
</pre></div>
</div>
<p>Non-hyperegeometric parts of the expression and hypergeometric expressions
that are not recognised are left unchanged:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hyperexpand</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">hyper</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="n">z</span><span class="p">))</span>
<span class="go">hyper((1, 1, 1), (), z) + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.hyperexpand_special">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">hyperexpand_special</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#hyperexpand_special"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.hyperexpand_special" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to find a closed-form expression for hyper(ap, bq, z), where <code class="docutils literal notranslate"><span class="pre">z</span></code>
is supposed to be a “special” value, e.g. 1.</p>
<p>This function tries various of the classical summation formulae
(Gauss, Saalschuetz, etc).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.make_derivative_operator">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">make_derivative_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#make_derivative_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.make_derivative_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a derivative operator, to be passed to Operator.apply.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.make_simp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">make_simp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#make_simp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.make_simp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a function that simplifies rational functions in <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.reduce_order">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">reduce_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#reduce_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.reduce_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the hypergeometric function <code class="docutils literal notranslate"><span class="pre">func</span></code>, find a sequence of operators to
reduces order as much as possible.</p>
<p>Return (newfunc, [operators]), where applying the operators to the
hypergeometric function newfunc yields func.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="n">reduce_order</span><span class="p">,</span> <span class="n">Hyper_Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="go">(Hyper_Function((1, 2), (3, 4)), [])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)))</span>
<span class="go">(Hyper_Function((), ()), [&lt;Reduce order by cancelling upper 1 with lower 1.&gt;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order</span><span class="p">(</span><span class="n">Hyper_Function</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="go">(Hyper_Function((2,), (3,)), [&lt;Reduce order by cancelling</span>
<span class="go">upper 4 with lower 3.&gt;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.reduce_order_meijer">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">reduce_order_meijer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#reduce_order_meijer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.reduce_order_meijer" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the Meijer G function parameters, <code class="docutils literal notranslate"><span class="pre">func</span></code>, find a sequence of
operators that reduces order as much as possible.</p>
<p>Return newfunc, [operators].</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.hyperexpand</span> <span class="kn">import</span> <span class="p">(</span><span class="n">reduce_order_meijer</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">G_Function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">G_Function((4, 3), (5, 6), (3, 4), (2, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">G_Function((3,), (5, 6), (3, 4), (1,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">G_Function((3,), (), (), (1,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_order_meijer</span><span class="p">(</span><span class="n">G_Function</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">G_Function((), (), (), ())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.try_lerchphi">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">try_lerchphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#try_lerchphi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.try_lerchphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to find an expression for Hyper_Function <code class="docutils literal notranslate"><span class="pre">func</span></code> in terms of Lerch
Transcendents.</p>
<p>Return None if no such expression can be found.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.try_polynomial">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">try_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#try_polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.try_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Recognise polynomial cases. Returns None if not such a case.
Requires order to be fully reduced.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.hyperexpand.try_shifted_sum">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.hyperexpand.</span></span><span class="sig-name descname"><span class="pre">try_shifted_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/hyperexpand.html#try_shifted_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.hyperexpand.try_shifted_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to recognise a hypergeometric sum that starts from k &gt; 0.</p>
</dd></dl>

</section>
<section id="modelparameters-sympy-simplify-hyperexpand-doc-module">
<h2>modelparameters.sympy.simplify.hyperexpand_doc module<a class="headerlink" href="#modelparameters-sympy-simplify-hyperexpand-doc-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-modelparameters.sympy.simplify.powsimp">
<span id="modelparameters-sympy-simplify-powsimp-module"></span><h2>modelparameters.sympy.simplify.powsimp module<a class="headerlink" href="#module-modelparameters.sympy.simplify.powsimp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.powsimp.powdenest">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.powsimp.</span></span><span class="sig-name descname"><span class="pre">powdenest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/powsimp.html#powdenest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.powsimp.powdenest" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect exponents on powers as assumptions allow.</p>
<dl class="simple">
<dt>Given <code class="docutils literal notranslate"><span class="pre">(bb**be)**e</span></code>, this can be simplified as follows:</dt><dd><ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">bb</span></code> is positive, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> is an integer, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|be|</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> then this simplifies to <code class="docutils literal notranslate"><span class="pre">bb**(be*e)</span></code></p></li>
</ul>
</dd>
</dl>
<p>Given a product of powers raised to a power, <code class="docutils literal notranslate"><span class="pre">(bb1**be1</span> <span class="pre">*</span>
<span class="pre">bb2**be2...)**e</span></code>, simplification can be done as follows:</p>
<ul class="simple">
<li><p>if e is positive, the gcd of all bei can be joined with e;</p></li>
<li><p>all non-negative bb can be separated from those that are negative
and their gcd can be joined with e; autosimplification already
handles this separation.</p></li>
<li><p>integer factors from powers that have integers in the denominator
of the exponent can be removed from any term and the gcd of such
integers can be joined with e</p></li>
</ul>
<p>Setting <code class="docutils literal notranslate"><span class="pre">force</span></code> to True will make symbols that are not explicitly
negative behave as though they are positive, resulting in more
denesting.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">polar</span></code> to True will do simplifications on the Riemann surface of
the logarithm, also resulting in more denestings.</p>
<p>When there are sums of logs in exp() then a product of powers may be
obtained e.g. <code class="docutils literal notranslate"><span class="pre">exp(3*(log(a)</span> <span class="pre">+</span> <span class="pre">2*log(b)))</span></code> - &gt; <code class="docutils literal notranslate"><span class="pre">a**3*b**6</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">powdenest</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">(x**(2*a/3))**(3*x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">2**(3*x)</span>
</pre></div>
</div>
<p>Assumptions may prevent expansion:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(x**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">p</span>
</pre></div>
</div>
<p>No other expansion is done.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i,j&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">))</span> <span class="c1"># -X-&gt; (x**x)**i*(x**x)**j</span>
<span class="go">x**(x*(i + j))</span>
</pre></div>
</div>
<p>But exp() will be denested by moving all non-log terms outside of
the function; this may result in the collapsing of the exp to a power
with a different base:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">x**(3*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">))))</span>
<span class="go">(a*b)**y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">))))</span>
<span class="go">a**3*b**3</span>
</pre></div>
</div>
<p>If assumptions allow, symbols can also be moved to the outermost exponent:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">((x**(2*i))**(3*y))**x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**(6*i*x*y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">(((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">((x**(2*a/3))**(3*y/i))**x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">))</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(x*y**2)**(2*i*z)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**(i*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powdenest</span><span class="p">((</span><span class="n">n</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n**i)**x</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.powsimp.powsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.powsimp.</span></span><span class="sig-name descname"><span class="pre">powsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine='all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure=&lt;function</span> <span class="pre">count_ops&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/powsimp.html#powsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.powsimp.powsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>reduces expression by combining powers with similar bases and exponents.</p>
<p class="rubric">Notes</p>
<p>If deep is True then powsimp() will also simplify arguments of
functions. By default deep is set to False.</p>
<p>If force is True then bases will be combined without checking for
assumptions, e.g. sqrt(x)*sqrt(y) -&gt; sqrt(x*y) which is not true
if x and y are both negative.</p>
<p>You can make powsimp() only combine bases or only combine exponents by
changing combine=’base’ or combine=’exp’.  By default, combine=’all’,
which does both.  combine=’base’ will only combine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">a</span>   <span class="n">a</span>          <span class="n">a</span>                          <span class="mi">2</span><span class="n">x</span>      <span class="n">x</span>
<span class="n">x</span> <span class="o">*</span> <span class="n">y</span>  <span class="o">=&gt;</span>  <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>   <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">things</span> <span class="n">like</span> <span class="mi">2</span>   <span class="o">=&gt;</span>  <span class="mi">4</span>
</pre></div>
</div>
<p>and combine=’exp’ will only combine</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">a</span>   <span class="n">b</span>      <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="n">x</span> <span class="o">*</span> <span class="n">x</span>  <span class="o">=&gt;</span>  <span class="n">x</span>
</pre></div>
</div>
<p>combine=’exp’ will strictly only combine exponents in the way that used
to be automatic.  Also use deep=True if you need the old behavior.</p>
<p>When combine=’all’, ‘exp’ is evaluated first.  Consider the first
example below for when there could be an ambiguity relating to this.
This is done so things like the second example can be completely
combined.  If you want ‘base’ combined first, do something like
powsimp(powsimp(expr, combine=’base’), combine=’exp’).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">powsimp</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">x**(y + z)*y**z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
<span class="go">x**(y + z)*y**z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="n">z</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**y*(x*y)**z</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n*x)**(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
<span class="go">n**(y + z)*x**(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">z</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(n*x)**y*(n*x)**z</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="go">log(exp(x)*exp(y))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x + y</span>
</pre></div>
</div>
<p>Radicals with Mul bases will be combined if combine=’exp’</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Mul</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Two radicals are automatically joined through Mul:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span> <span class="o">==</span> <span class="n">a</span><span class="o">**</span><span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But if an integer power of that radical has been
autoexpanded then Mul does not join the resulting factors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">**</span><span class="mi">4</span> <span class="c1"># auto expands to a Mul, no longer a Pow</span>
<span class="go">x**2*y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">*</span><span class="n">a</span> <span class="c1"># so Mul doesn&#39;t combine them</span>
<span class="go">x**2*y*sqrt(x*sqrt(y))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="c1"># but powsimp will</span>
<span class="go">(x*sqrt(y))**(5/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="c1"># but won&#39;t when doing so would violate assumptions</span>
<span class="go">x*y*sqrt(x*sqrt(y))</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.radsimp">
<span id="modelparameters-sympy-simplify-radsimp-module"></span><h2>modelparameters.sympy.simplify.radsimp module<a class="headerlink" href="#module-modelparameters.sympy.simplify.radsimp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.collect">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribute_order_term</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect additive terms of an expression.</p>
<p>This function collects additive terms of an expression with respect
to a list of expression up to powers with rational exponents. By the
term symbol here are meant arbitrary expressions, which can contain
powers, products, sums etc. In other words symbol is a pattern which
will be searched for in the expression’s terms.</p>
<p>The input expression is not expanded by <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a>, so user is
expected to provide an expression is an appropriate form. This makes
<a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> more predictable as there is no magic happening behind the
scenes. However, it is important to note, that powers of products are
converted to products of powers using the <code class="xref py py-func docutils literal notranslate"><span class="pre">expand_power_base()</span></code>
function.</p>
<p>There are two possible types of output. First, if <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> flag is
set, this function will return an expression with collected terms or
else it will return a dictionary with expressions up to rational powers
as keys and collected coefficients as values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">Wild</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
</pre></div>
</div>
<p>This function can collect symbolic coefficients in polynomials or
rational expressions. It will manage to find all integer or rational
powers of collection variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">c + x**2*(a + b) + x*(a - b)</span>
</pre></div>
</div>
<p>The same result can be achieved in dictionary form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<span class="go">a + b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="go">a - b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
<span class="go">c</span>
</pre></div>
</div>
<p>You can also work with multivariate polynomials. However, remember that
this function is greedy so it will care only about a single symbol at time,
in specification order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="go">x**2*(y + 1) + x*y + y*(a + 1)</span>
</pre></div>
</div>
<p>Also more complicated expressions can be used as patterns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*sin(2*x)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">x*(a + b)*log(x)</span>
</pre></div>
</div>
<p>You can use wildcards in the pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">Wild</span><span class="p">(</span><span class="s1">&#39;w1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">**</span><span class="n">y</span><span class="p">)</span>
<span class="go">x**y*(a - b)</span>
</pre></div>
</div>
<p>It is also possible to work with symbolic powers, although it has more
complicated behavior, because in this case power’s base and symbolic part
of the exponent are treated as a single symbol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">a*x**c + b*x**c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
<span class="go">x**c*(a + b)</span>
</pre></div>
</div>
<p>However if you incorporate rationals to the exponents, then you will get
well known behavior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">),</span> <span class="n">x</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>
<span class="go">x**(2*c)*(a + b)</span>
</pre></div>
</div>
<p>Note also that all previously stated facts about <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a> function
apply to the exponential function, so you can get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*exp(2*x)</span>
</pre></div>
</div>
<p>If you are interested only in collecting specific powers of some symbols
then set <code class="docutils literal notranslate"><span class="pre">exact</span></code> flag in arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">a*x**7 + b*x**7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**7*(a + b)</span>
</pre></div>
</div>
<p>You can also apply this function to differential equations, where
derivatives of arbitrary order can be collected. Note that if you
collect with respect to a function or a derivative of a function, all
derivatives of that function will also be collected. Use
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> to prevent this from happening:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Derivative</span> <span class="k">as</span> <span class="n">D</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*Derivative(f(x), x)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">),</span> <span class="n">f</span><span class="p">)</span>
<span class="go">(a + b)*Derivative(f(x), x, x)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">a*Derivative(f(x), x, x) + b*Derivative(f(x), x, x)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">(a + b)*f(x) + (a + b)*Derivative(f(x), x)</span>
</pre></div>
</div>
<p>Or you can even match both derivative order and exponent at the same time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">D</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">D</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
<span class="go">(a + b)*Derivative(f(x), x, x)**2</span>
</pre></div>
</div>
<p>Finally, you can apply a function to each of the collected coefficients.
For example you can factorize symbolic coefficients of polynomial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">collect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
<span class="go">x**3 + 3*x**2*(a + 1) + 3*x*(a + 1)**2 + (a + 1)**3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Arguments are expected to be in expanded form, so you might have
to call <code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code> prior to calling this function.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_const" title="modelparameters.sympy.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_sqrt" title="modelparameters.sympy.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.rcollect" title="modelparameters.sympy.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.collect_const">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">collect_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#collect_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.collect_const" title="Permalink to this definition">¶</a></dt>
<dd><p>A non-greedy collection of terms with similar number coefficients in
an Add expr. If <code class="docutils literal notranslate"><span class="pre">vars</span></code> is given then only those constants will be
targeted. Although any Number can also be targeted, if this is not
desired set <code class="docutils literal notranslate"><span class="pre">Numbers=False</span></code> and no Float or Rational will be collected.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.radsimp</span> <span class="kn">import</span> <span class="n">collect_const</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">sqrt(3)*(sqrt(2) + 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">(sqrt(3) + sqrt(7))*(s + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">(sqrt(2) + 3)*(sqrt(3) + sqrt(7))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">sqrt(7) + sqrt(3)*(sqrt(2) + 3) + sqrt(7)*(sqrt(2) + 2)</span>
</pre></div>
</div>
<p>The collection is sign-sensitive, giving higher precedence to the
unsigned values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="go">x - (y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="o">-</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="go">-(y + z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">2*(x - y - z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_const</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*x - 2*(y + z)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_sqrt" title="modelparameters.sympy.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.rcollect" title="modelparameters.sympy.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.collect_sqrt">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">collect_sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#collect_sqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.collect_sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return expr with terms having common square roots collected together.
If <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is False a count indicating the number of sqrt-containing
terms will be returned and, if non-zero, the terms of the Add will be
returned, else the expression itself will be returned as a single term.
If <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> is True, the expression with any collected terms will be
returned.</p>
<p>Note: since I = sqrt(-1), it is collected, too.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.radsimp</span> <span class="kn">import</span> <span class="n">collect_sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r5</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span><span class="p">)</span>
<span class="go">sqrt(2)*(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r3</span><span class="p">)</span>
<span class="go">sqrt(2)*(a + b) + sqrt(3)*(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">)</span>
<span class="go">sqrt(3)*a + sqrt(5)*b + sqrt(2)*(a + b)</span>
</pre></div>
</div>
<p>If evaluate is False then the arguments will be sorted and
returned as a list and a count of the number of sqrt-containing
terms will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((sqrt(3)*a, sqrt(5)*b, sqrt(2)*(a + b)), 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((b, sqrt(2)*a), 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">((a + b,), 0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_const" title="modelparameters.sympy.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.rcollect" title="modelparameters.sympy.simplify.radsimp.rcollect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcollect</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.denom">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">denom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#denom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.denom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.denom_expand">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">denom_expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#denom_expand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.denom_expand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.expand_denom">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">expand_denom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.expand_denom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.expand_fraction">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">expand_fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.expand_fraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.expand_numer">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">expand_numer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.expand_numer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.fraction">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#fraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pair with expression’s numerator and denominator.
If the given expression is not a fraction then this function
will return the tuple (expr, 1).</p>
<p>This function will not make any attempt to simplify nested
fractions or to do any term rewriting at all.</p>
<p>If only one of the numerator/denominator pair is needed then
use numer(expr) or denom(expr) functions respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(x, 1)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, y**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(x*y, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
<p>This function will also work fine with assumptions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="go">(x, y**(-k))</span>
</pre></div>
</div>
<p>If we know nothing about sign of some exponent and ‘exact’
flag is unset, then structure this exponent’s structure will
be analyzed and pretty fraction will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">Mul</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
<span class="go">(2, x**y)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="go">(1, exp(x))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(exp(-x), 1)</span>
</pre></div>
</div>
<p>The <cite>exact</cite> flag will also keep any unevaluated Muls from
being evaluated:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">(2*x + 2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2*(x  + 1), 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.fraction_expand">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">fraction_expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#fraction_expand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.fraction_expand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.numer">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">numer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#numer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.numer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.numer_expand">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">numer_expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#numer_expand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.numer_expand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.rad_rationalize">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">rad_rationalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">den</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#rad_rationalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.rad_rationalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Rationalize num/den by removing square roots in the denominator;
num and den are sum of terms whose squares are rationals</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.radsimp</span> <span class="kn">import</span> <span class="n">rad_rationalize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad_rationalize</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(-sqrt(3) + sqrt(6)/3, -7/9)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.radsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">radsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbolic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#radsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.radsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Rationalize the denominator by removing square roots.</p>
<p>Note: the expression returned from radsimp must be used with caution
since if the denominator contains symbols, it will be possible to make
substitutions that violate the assumptions of the simplification process:
that for a denominator matching a + b*sqrt(c), a != +/-b*sqrt(c). (If
there are no symbols, this assumptions is made valid by collecting terms
of sqrt(c) so the match variable <code class="docutils literal notranslate"><span class="pre">a</span></code> does not contain <code class="docutils literal notranslate"><span class="pre">sqrt(c)</span></code>.) If
you do not want the simplification to occur for symbolic denominators, set
<code class="docutils literal notranslate"><span class="pre">symbolic</span></code> to False.</p>
<p>If there are more than <code class="docutils literal notranslate"><span class="pre">max_terms</span></code> radical terms then the expression is
returned unchanged.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">radsimp</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">denom</span><span class="p">,</span> <span class="n">pprint</span><span class="p">,</span> <span class="n">I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">factor_terms</span><span class="p">,</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">signsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.radsimp</span> <span class="kn">import</span> <span class="n">collect_sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">(-sqrt(2) + 2)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">Symbol</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">sqrt(2)*(x + y)</span>
</pre></div>
</div>
<p>No simplification beyond removal of the gcd is done. One might
want to polish the result a little, however, by collecting
square root terms:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r5</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">radsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">r2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">r5</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">r5</span><span class="p">));</span> <span class="n">pprint</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="go">    ___       ___       ___       ___</span>
<span class="go">  \/ 5 *a + \/ 5 *b - \/ 2 *x - \/ 2 *y</span>
<span class="go">------------------------------------------</span>
<span class="go">   2               2      2              2</span>
<span class="go">5*a  + 10*a*b + 5*b  - 2*x  - 4*x*y - 2*y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">factor_terms</span><span class="p">(</span><span class="n">signsimp</span><span class="p">(</span><span class="n">collect_sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">d</span><span class="p">,</span> <span class="n">radical</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">        ___             ___</span>
<span class="go">      \/ 5 *(a + b) - \/ 2 *(x + y)</span>
<span class="go">------------------------------------------</span>
<span class="go">   2               2      2              2</span>
<span class="go">5*a  + 10*a*b + 5*b  - 2*x  - 4*x*y - 2*y</span>
</pre></div>
</div>
<p>If radicals in the denominator cannot be removed or there is no denominator,
the original expression will be returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(2)*x + sqrt(2)</span>
</pre></div>
</div>
<p>Results with symbols will not always be valid for all substitutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="go">1/(2*b*sqrt(c))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="go">nan</span>
</pre></div>
</div>
<p>If symbolic=False, symbolic denominators will not be transformed (but
numeric denominators will still be processed):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radsimp</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">1/(a + b*sqrt(c))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.rcollect">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">rcollect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">vars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#rcollect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.rcollect" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively collect sums in an expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..simplify</span> <span class="kn">import</span> <span class="n">rcollect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rcollect</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(x + y*(x**2 + x + 1))/(x + y)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect" title="modelparameters.sympy.simplify.radsimp.collect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_const" title="modelparameters.sympy.simplify.radsimp.collect_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_const</span></code></a>, <a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_sqrt" title="modelparameters.sympy.simplify.radsimp.collect_sqrt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">collect_sqrt</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.radsimp.split_surds">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.radsimp.</span></span><span class="sig-name descname"><span class="pre">split_surds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/radsimp.html#split_surds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.radsimp.split_surds" title="Permalink to this definition">¶</a></dt>
<dd><p>split an expression with terms whose squares are rationals
into a sum of terms whose surds squared have gcd equal to g
and a sum of terms with surds squared prime with g</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.radsimp</span> <span class="kn">import</span> <span class="n">split_surds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_surds</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="go">(3, sqrt(2) + sqrt(5) + 3, sqrt(5)/7 + sqrt(10))</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.ratsimp">
<span id="modelparameters-sympy-simplify-ratsimp-module"></span><h2>modelparameters.sympy.simplify.ratsimp module<a class="headerlink" href="#module-modelparameters.sympy.simplify.ratsimp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.ratsimp.ratsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.ratsimp.</span></span><span class="sig-name descname"><span class="pre">ratsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/ratsimp.html#ratsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.ratsimp.ratsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an expression over a common denominator, cancel and reduce.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">ratsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x + y)/(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.ratsimp.ratsimpmodprime">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.ratsimp.</span></span><span class="sig-name descname"><span class="pre">ratsimpmodprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/ratsimp.html#ratsimpmodprime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.ratsimp.ratsimpmodprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplifies a rational expression <code class="docutils literal notranslate"><span class="pre">expr</span></code> modulo the prime ideal
generated by <code class="docutils literal notranslate"><span class="pre">G</span></code>.  <code class="docutils literal notranslate"><span class="pre">G</span></code> should be a Groebner basis of the
ideal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.ratsimp</span> <span class="kn">import</span> <span class="n">ratsimpmodprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratsimpmodprime</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="go">(x**2 + x*y + x + y)/(x**2 - x*y)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">polynomial</span></code> is False, the algorithm computes a rational
simplification which minimizes the sum of the total degrees of
the numerator and the denominator.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">polynomial</span></code> is True, this function just brings numerator and
denominator into a canonical form. This is much faster, but has
potentially worse results.</p>
<p class="rubric">References</p>
<p>M. Monagan, R. Pearce, Rational Simplification Modulo a Polynomial
Ideal,
<a class="reference external" href="http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.163.6984">http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.163.6984</a>
(specifically, the second algorithm)</p>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.simplify">
<span id="modelparameters-sympy-simplify-simplify-module"></span><h2>modelparameters.sympy.simplify.simplify module<a class="headerlink" href="#module-modelparameters.sympy.simplify.simplify" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.besselsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">besselsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#besselsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.besselsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify bessel-type functions.</p>
<p>This routine tries to simplify bessel-type functions. Currently it only
works on the Bessel J and I functions, however. It works by looking at all
such functions in turn, and eliminating factors of “I” and “-1” (actually
their polar equivalents) in front of the argument. Then, functions of
half-integer order are rewritten using strigonometric functions and
functions of integer order (&gt; 1) are rewritten using functions
of low order.  Finally, if the expression was changed, compute
factorization of the result with factor().</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">besselj</span><span class="p">,</span> <span class="n">besseli</span><span class="p">,</span> <span class="n">besselsimp</span><span class="p">,</span> <span class="n">polar_lift</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">z</span><span class="p">,</span> <span class="n">nu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besselj</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">exp(I*pi*nu)*besselj(nu, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)))</span>
<span class="go">exp(-I*pi*nu/2)*besselj(nu, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="go">sqrt(2)*cosh(z)/(sqrt(pi)*sqrt(z))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">besselsimp</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">besseli</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">besseli</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">besseli</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="go">3*z*besseli(0, z)/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.bottom_up">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">bottom_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonbasic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#bottom_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.bottom_up" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <code class="docutils literal notranslate"><span class="pre">F</span></code> to all expressions in an expression tree from the
bottom up. If <code class="docutils literal notranslate"><span class="pre">atoms</span></code> is True, apply <code class="docutils literal notranslate"><span class="pre">F</span></code> even if there are no args;
if <code class="docutils literal notranslate"><span class="pre">nonbasic</span></code> is True, try to apply <code class="docutils literal notranslate"><span class="pre">F</span></code> to non-Basic objects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.clear_coefficients">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">clear_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#clear_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.clear_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>p, r</cite> where <cite>p</cite> is the expression obtained when Rational
additive and multiplicative coefficients of <cite>expr</cite> have been stripped
away in a naive fashion (i.e. without simplification). The operations
needed to remove the coefficients will be applied to <cite>rhs</cite> and returned
as <cite>r</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.simplify</span> <span class="kn">import</span> <span class="n">clear_coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clear_coefficients</span><span class="p">(</span><span class="n">expr</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(y*(2*x + 1), 1/6)</span>
</pre></div>
</div>
<p>When solving 2 or more expressions like <cite>expr = a</cite>,
<cite>expr = b</cite>, etc…, it is advantageous to provide a Dummy symbol
for <cite>rhs</cite> and  simply replace it with <cite>a</cite>, <cite>b</cite>, etc… in <cite>r</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rhs</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;rhs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clear_coefficients</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="go">(y*(2*x + 1), _rhs/12)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1/6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.factor_sum">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">factor_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#factor_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.factor_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for Sum simplification</p>
<p>if limits is specified, “self” is the inner part of a sum</p>
<p>Returns the sum with constant factors brought outside</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.hypersimilar">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">hypersimilar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#hypersimilar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.hypersimilar" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if ‘f’ and ‘g’ are hyper-similar.</p>
<p>Similarity in hypergeometric sense means that a quotient of
f(k) and g(k) is a rational function in k.  This procedure
is useful in solving recurrence relations.</p>
<p>For more information see hypersimp().</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.hypersimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">hypersimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#hypersimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.hypersimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Given combinatorial term f(k) simplify its consecutive term ratio
i.e. f(k+1)/f(k).  The input term can be composed of functions and
integer sequences which have equivalent representation in terms
of gamma special function.</p>
<p>The algorithm performs three basic steps:</p>
<ol class="arabic simple">
<li><p>Rewrite all functions in terms of gamma, if possible.</p></li>
<li><p>Rewrite all occurrences of gamma in terms of products
of gamma and rising factorial with integer,  absolute
constant exponent.</p></li>
<li><p>Perform simplification of nested fractions, powers
and if the resulting expression is a quotient of
polynomials, reduce their total degree.</p></li>
</ol>
<p>If f(k) is hypergeometric then as result we arrive with a
quotient of polynomials of minimal degree. Otherwise None
is returned.</p>
<p>For more information on the implemented algorithm refer to:</p>
<ol class="arabic simple">
<li><p>W. Koepf, Algorithms for m-fold Hypergeometric Summation,
Journal of Symbolic Computation (1995) 20, 399-417</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.logcombine">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">logcombine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#logcombine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.logcombine" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes logarithms and combines them using the following rules:</p>
<ul class="simple">
<li><p>log(x) + log(y) == log(x*y) if both are not negative</p></li>
<li><p>a*log(x) == log(x**a) if x is positive and a is real</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">force</span></code> is True then the assumptions above will be assumed to hold if
there is no assumption already in place on a quantity. For example, if
<code class="docutils literal notranslate"><span class="pre">a</span></code> is imaginary or the argument negative, force will not perform a
combination but if <code class="docutils literal notranslate"><span class="pre">a</span></code> is a symbol with no assumptions the change will
take place.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">logcombine</span><span class="p">,</span> <span class="n">I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">a*log(x) + log(y) - log(z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(x**a*y/z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">log(x**a*y/z)</span>
</pre></div>
</div>
<p>The transformation is limited to factors and/or terms that
contain logs, so the result depends on the initial state of
expansion:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logcombine</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(x**2) + I*log(x**3)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.posify" title="modelparameters.sympy.simplify.simplify.posify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">posify</span></code></a></dt><dd><p>replace all symbols with symbols having positive assumptions</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.nsimplify">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">nsimplify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rational</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rational_conversion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'base10'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#nsimplify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.nsimplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a simple representation for a number or, if there are free symbols or
if rational=True, then replace Floats with their Rational equivalents. If
no change is made and rational is not False then Floats will at least be
converted to Rationals.</p>
<p>For numerical expressions, a simple formula that numerically matches the
given numerical expression is sought (and the input should be possible
to evalf to a precision of at least 30 digits).</p>
<p>Optionally, a list of (rationally independent) constants to
include in the formula may be given.</p>
<p>A lower tolerance may be set to find less exact matches. If no tolerance
is given then the least precise value will set the tolerance (e.g. Floats
default to 15 digits of precision, so would be tolerance=10**-15).</p>
<p>With full=True, a more extensive search is performed
(this is useful to find simpler numbers when the tolerance
is set low).</p>
<p>When converting to rational, if rational_conversion=’base10’ (the default), then
convert floats to rationals using their base-10 (string) representation.
When rational_conversion=’exact’ it uses the exact, base-2 representation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">nsimplify</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">GoldenRatio</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span> <span class="p">[</span><span class="n">GoldenRatio</span><span class="p">])</span>
<span class="go">-2 + 2*GoldenRatio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">1/2 - I*sqrt(sqrt(5)/10 + 1/4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="n">I</span><span class="o">**</span><span class="n">I</span><span class="p">,</span> <span class="p">[</span><span class="n">pi</span><span class="p">])</span>
<span class="go">exp(-pi/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="go">22/7</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="mf">0.333333333333333</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rational_conversion</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="go">6004799503160655/18014398509481984</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="mf">0.333333333333333</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">1/3</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.core.function.nfloat</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.nthroot">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">nthroot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#nthroot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.nthroot" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a real nth-root of a sum of surds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<em>sum</em><em> of </em><em>surds</em>) – </p></li>
<li><p><strong>n</strong> (<em>integer</em>) – </p></li>
<li><p><strong>max_len</strong> (maximum number of surds passed as constants to <code class="docutils literal notranslate"><span class="pre">nsimplify</span></code>) – </p></li>
<li><p><strong>Algorithm</strong> – </p></li>
<li><p><strong>=========</strong> – </p></li>
<li><p><strong>a</strong> (<em>First nsimplify is used to get a candidate root; if it is not</em>) – </p></li>
<li><p><strong>its</strong> (<em>root the minimal polynomial is computed; the answer is one of</em>) – </p></li>
<li><p><strong>roots.</strong> – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.simplify</span> <span class="kn">import</span> <span class="n">nthroot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthroot</span><span class="p">(</span><span class="mi">90</span> <span class="o">+</span> <span class="mi">34</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">sqrt(7) + 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.posify">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">posify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#posify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.posify" title="Permalink to this definition">¶</a></dt>
<dd><p>Return eq (with generic symbols made positive) and a
dictionary containing the mapping between the old and new
symbols.</p>
<p>Any symbol that has positive=None will be replaced with a positive dummy
symbol having the same name. This replacement will allow more symbolic
processing of expressions, especially those involving powers and
logarithms.</p>
<p>A dictionary that can be sent to subs to restore eq to its original
symbols is also returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">posify</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posify</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">(_x + n + p, {_x: x})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">log(1/x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">posify</span><span class="p">(</span><span class="n">eq</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">-log(_x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span> <span class="n">rep</span> <span class="o">=</span> <span class="n">posify</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">rep</span><span class="p">)</span>
<span class="go">-log(x)</span>
</pre></div>
</div>
<p>It is possible to apply the same transformations to an iterable
of expressions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">[-2, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq_x</span><span class="p">,</span> <span class="n">reps</span> <span class="o">=</span> <span class="n">posify</span><span class="p">([</span><span class="n">eq</span><span class="p">,</span> <span class="n">x</span><span class="p">]);</span> <span class="n">eq_x</span>
<span class="go">[_x**2 - 4, _x]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="o">*</span><span class="n">eq_x</span><span class="p">)</span>
<span class="go">[2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.product_mul">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">product_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#product_mul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.product_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for Product simplification</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.product_simplify">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">product_simplify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#product_simplify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.product_simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function for Product simplification</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.separatevars">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">separatevars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#separatevars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.separatevars" title="Permalink to this definition">¶</a></dt>
<dd><p>Separates variables in an expression, if possible.  By
default, it separates with respect to all symbols in an
expression and collects constant coefficients that are
independent of symbols.</p>
<p>If dict=True then the separated terms will be returned
in a dictionary keyed to their corresponding symbols.
By default, all symbols in the expression will appear as
keys; if symbols are provided, then all those symbols will
be used as keys, and any terms in the expression containing
other symbols or non-symbols will be returned keyed to the
string ‘coeff’. (Passing None for symbols will return the
expression in a dictionary keyed to ‘coeff’.)</p>
<p>If force=True, then bases of powers will be separated regardless
of assumptions on the symbols involved.</p>
<p class="rubric">Notes</p>
<p>The order of the factors is determined by Mul, so that the
separated expressions may not necessarily be grouped together.</p>
<p>Although factoring is necessary to separate variables in some
expressions, it is not necessary in all cases, so one should not
count on the returned factors being factored.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpha</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">separatevars</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x*y)**y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">x**y*y**y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2*x**2*z*(sin(y) + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;coeff&#39;: 2*z, x: x**2, y: sin(y) + 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="p">],</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{&#39;coeff&#39;: 2*z, alpha: 1, x: x**2, y: sin(y) + 1}</span>
</pre></div>
</div>
<p>If the expression is not really separable, or is only partially
separable, separatevars will do the best it can to separate it
by using factoring.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-x*(3*x - y - 1)</span>
</pre></div>
</div>
<p>If the expression is not separable then expr is returned unchanged
or (if dict=True) then None is returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span> <span class="o">==</span> <span class="n">eq</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.signsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">signsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#signsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.signsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Make all Add sub-expressions canonical wrt sign.</p>
<p>If an Add subexpression, <code class="docutils literal notranslate"><span class="pre">a</span></code>, can have a sign extracted,
as determined by could_extract_minus_sign, it is replaced
with Mul(-1, a, evaluate=False). This allows signs to be
extracted from powers and products.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">signsimp</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">odd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">/</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">x</span>
<span class="go">(-1 + 1/x)/(x*(1 - 1/x)**2) - 1/(x*(-1 + 1/x))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="n">x</span><span class="o">*-</span><span class="n">n</span>
<span class="go">x*(-1 + 1/x) + x*(1 - 1/x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Since powers automatically handle leading signs</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">i</span>
<span class="go">-2**i</span>
</pre></div>
</div>
<p>signsimp can be used to put the base of a power with an integer
exponent into canonical form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">**</span><span class="n">i</span>
<span class="go">(-1 + 1/x)**i</span>
</pre></div>
</div>
<p>By default, signsimp doesn’t leave behind any hollow simplification:
if making an Add canonical wrt sign didn’t change the expression, the
original Add is restored. If this is not desired then the keyword
<code class="docutils literal notranslate"><span class="pre">evaluate</span></code> can be set to False:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signsimp</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="n">e</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signsimp</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">exp(-(x - y))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.simplify">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">simplify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio=1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure=&lt;function</span> <span class="pre">count_ops&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fu=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#simplify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplifies the given expression.</p>
<p>Simplification is not a well defined term and the exact strategies
this function tries can change in the future versions of SymPy. If
your algorithm relies on “simplification” (whatever it is), try to
determine what you need exactly  -  is it powsimp()?, radsimp()?,
together()?, logcombine()?, or something else? And use this particular
function directly, because those are well defined and thus your algorithm
will be robust.</p>
<p>Nonetheless, especially for interactive use, or when you don’t know
anything about the structure of the expression, simplify() tries to apply
intelligent heuristics to make the input expression “simpler”.  For
example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">(x**2 + x)/(x*sin(y)**2 + x*cos(y)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>Note that we could have obtained the same result by using specific
simplification functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">trigsimp</span><span class="p">,</span> <span class="n">cancel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(x**2 + x)/x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>In some cases, applying <a class="reference internal" href="#modelparameters.sympy.simplify.simplify.simplify" title="modelparameters.sympy.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> may actually result in some more
complicated expression. The default <code class="docutils literal notranslate"><span class="pre">ratio=1.7</span></code> prevents more extreme
cases: if (result length)/(input length) &gt; ratio, then input is returned
unmodified.  The <code class="docutils literal notranslate"><span class="pre">measure</span></code> parameter lets you specify the function used
to determine how complex an expression is.  The function should take a
single argument as an expression and return a number such that if
expression <code class="docutils literal notranslate"><span class="pre">a</span></code> is more complex than expression <code class="docutils literal notranslate"><span class="pre">b</span></code>, then
<code class="docutils literal notranslate"><span class="pre">measure(a)</span> <span class="pre">&gt;</span> <span class="pre">measure(b)</span></code>.  The default measure function is
<code class="xref py py-func docutils literal notranslate"><span class="pre">count_ops()</span></code>, which returns the total number of operations in the
expression.</p>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">ratio=1</span></code>, <code class="docutils literal notranslate"><span class="pre">simplify</span></code> output can’t be longer
than input.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">count_ops</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">simplify(root)</span></code> would result in a slightly longer expression,
root is returned unchanged instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">root</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">ratio=oo</span></code>, simplify will be applied anyway:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="n">oo</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">count_ops</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that the shortest expression is not necessary the simplest, so
setting <code class="docutils literal notranslate"><span class="pre">ratio</span></code> to 1 may not be a good idea.
Heuristically, the default value <code class="docutils literal notranslate"><span class="pre">ratio=1.7</span></code> seems like a reasonable
choice.</p>
<p>You can easily define your own measure function based on what you feel
should represent the “size” or “complexity” of the input expression.  Note
that some choices, such as <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">expr:</span> <span class="pre">len(str(expr))</span></code> may appear to be
good metrics, but have other problems (in this case, the measure function
may slow down simplify too much for very large expressions).  If you don’t
know what a good metric would be, the default, <code class="docutils literal notranslate"><span class="pre">count_ops</span></code>, is a good
one.</p>
<p>For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">log(a*b**(-log(a) + 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count_ops</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>So you can see that <code class="docutils literal notranslate"><span class="pre">h</span></code> is simpler than <code class="docutils literal notranslate"><span class="pre">g</span></code> using the count_ops metric.
However, we may not like how <code class="docutils literal notranslate"><span class="pre">simplify</span></code> (in this case, using
<code class="docutils literal notranslate"><span class="pre">logcombine</span></code>) has created the <code class="docutils literal notranslate"><span class="pre">b**(log(1/a)</span> <span class="pre">+</span> <span class="pre">1)</span></code> term.  A simple way
to reduce this would be to give more weight to powers as operations in
<code class="docutils literal notranslate"><span class="pre">count_ops</span></code>.  We can do this by using the <code class="docutils literal notranslate"><span class="pre">visual=True</span></code> option:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_ops</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">2*ADD + DIV + 4*LOG + MUL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">count_ops</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">2*LOG + MUL + POW + SUB</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_measure</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">POW</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;POW&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Discourage powers by giving POW a weight of 10</span>
<span class="gp">... </span>    <span class="n">count</span> <span class="o">=</span> <span class="n">count_ops</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">POW</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Every other operation gets a weight of 1 (the default)</span>
<span class="gp">... </span>    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">Symbol</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">15.</span><span class="o">/</span><span class="mi">8</span> <span class="o">&gt;</span> <span class="mf">1.7</span> <span class="c1"># 1.7 is the default ratio</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simplify</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">measure</span><span class="o">=</span><span class="n">my_measure</span><span class="p">)</span>
<span class="go">-log(a)*log(b) + log(a) + log(b)</span>
</pre></div>
</div>
<p>Note that because <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> internally tries many different
simplification strategies and then compares them using the measure
function, we get a completely different result that is still different
from the input expression by doing this.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.sum_add">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">sum_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#sum_add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.sum_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for Sum simplification</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.sum_combine">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">sum_combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#sum_combine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.sum_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for Sum simplification</p>
<p>Attempts to simplify a list of sums, by combining limits / sum function’s
returns the simplified sum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.simplify.sum_simplify">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.simplify.</span></span><span class="sig-name descname"><span class="pre">sum_simplify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/simplify.html#sum_simplify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.simplify.sum_simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function for Sum simplification</p>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.sqrtdenest">
<span id="modelparameters-sympy-simplify-sqrtdenest-module"></span><h2>modelparameters.sympy.simplify.sqrtdenest module<a class="headerlink" href="#module-modelparameters.sympy.simplify.sqrtdenest" title="Permalink to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.SqrtdenestStopIteration">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">SqrtdenestStopIteration</span></span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#SqrtdenestStopIteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.SqrtdenestStopIteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#StopIteration" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopIteration</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.is_algebraic">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">is_algebraic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#is_algebraic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.is_algebraic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if p is comprised of only Rationals or square roots
of Rationals and algebraic operations.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..functions.elementary.miscellaneous</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.sqrtdenest</span> <span class="kn">import</span> <span class="n">is_algebraic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_algebraic</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_algebraic</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.is_sqrt">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">is_sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#is_sqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.is_sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if expr is a sqrt, otherwise False.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.sqrt_biquadratic_denest">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">sqrt_biquadratic_denest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#sqrt_biquadratic_denest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.sqrt_biquadratic_denest" title="Permalink to this definition">¶</a></dt>
<dd><p>denest expr = sqrt(a + b*sqrt(r))
where a, b, r are linear combinations of square roots of
positive rationals on the rationals (SQRR) and r &gt; 0, b != 0,
d2 = a**2 - b**2*r &gt; 0</p>
<p>If it cannot denest it returns None.</p>
<p>ALGORITHM
Search for a solution A of type SQRR of the biquadratic equation
4*A**4 - 4*a*A**2 + b**2*r = 0                               (1)
sqd = sqrt(a**2 - b**2*r)
Choosing the sqrt to be positive, the possible solutions are
A = sqrt(a/2 +/- sqd/2)
Since a, b, r are SQRR, then a**2 - b**2*r is a SQRR,
so if sqd can be denested, it is done by
_sqrtdenest_rec, and the result is a SQRR.
Similarly for A.
Examples of solutions (in both cases a and sqd are positive):</p>
<blockquote>
<div><p>Example of expr with solution sqrt(a/2 + sqd/2) but not
solution sqrt(a/2 - sqd/2):
expr = sqrt(-sqrt(15) - sqrt(2)*sqrt(-sqrt(5) + 5) - sqrt(3) + 8)
a = -sqrt(15) - sqrt(3) + 8; sqd = -2*sqrt(5) - 2 + 4*sqrt(3)</p>
<p>Example of expr with solution sqrt(a/2 - sqd/2) but not
solution sqrt(a/2 + sqd/2):
w = 2 + r2 + r3 + (1 + r3)*sqrt(2 + r2 + 5*r3)
expr = sqrt((w**2).expand())
a = 4*sqrt(6) + 8*sqrt(2) + 47 + 28*sqrt(3)
sqd = 29 + 20*sqrt(3)</p>
</div></blockquote>
<p>Define B = b/2*A; eq.(1) implies a = A**2 + B**2*r; then
expr**2 = a + b*sqrt(r) = (A + B*sqrt(r))**2</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.sqrtdenest</span> <span class="kn">import</span> <span class="n">_sqrt_match</span><span class="p">,</span> <span class="n">sqrt_biquadratic_denest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">_sqrt_match</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt_biquadratic_denest</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
<span class="go">sqrt(2) + sqrt(sqrt(2) + 2) + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.sqrt_depth">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">sqrt_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#sqrt_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.sqrt_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum depth of any square root argument of p.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..functions.elementary.miscellaneous</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.sqrtdenest</span> <span class="kn">import</span> <span class="n">sqrt_depth</span>
</pre></div>
</div>
<p>Neither of these square roots contains any other square roots
so the depth is 1:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt_depth</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The sqrt(3) is contained within a square root so the depth is
2:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt_depth</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.sqrtdenest.sqrtdenest">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.sqrtdenest.</span></span><span class="sig-name descname"><span class="pre">sqrtdenest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/sqrtdenest.html#sqrtdenest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.sqrtdenest.sqrtdenest" title="Permalink to this definition">¶</a></dt>
<dd><p>Denests sqrts in an expression that contain other square roots
if possible, otherwise returns the expr unchanged. This is based on the
algorithms of [1].</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.sqrtdenest</span> <span class="kn">import</span> <span class="n">sqrtdenest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrtdenest</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<span class="go">sqrt(2) + sqrt(3)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.solvers.solvers.unrad</span></code></p>
</div>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="http://researcher.watson.ibm.com/researcher/files/us-fagin/symb85.pdf">http://researcher.watson.ibm.com/researcher/files/us-fagin/symb85.pdf</a></p>
<p>[2] D. J. Jeffrey and A. D. Rich, ‘Symplifying Square Roots of Square Roots
by Denesting’ (available at <a class="reference external" href="http://www.cybertester.com/data/denest.pdf">http://www.cybertester.com/data/denest.pdf</a>)</p>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.traversaltools">
<span id="modelparameters-sympy-simplify-traversaltools-module"></span><h2>modelparameters.sympy.simplify.traversaltools module<a class="headerlink" href="#module-modelparameters.sympy.simplify.traversaltools" title="Permalink to this heading">¶</a></h2>
<p>Tools for applying functions to specified parts of expressions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.traversaltools.use">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.traversaltools.</span></span><span class="sig-name descname"><span class="pre">use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/traversaltools.html#use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.traversaltools.use" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">func</span></code> to transform <code class="docutils literal notranslate"><span class="pre">expr</span></code> at the given level.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">use</span><span class="p">,</span> <span class="n">expand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">use</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x*(x**2 + 2*x*y + y**2) + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">x**3 + 2*x**2*y + x*y**2 + 1</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify.trigsimp">
<span id="modelparameters-sympy-simplify-trigsimp-module"></span><h2>modelparameters.sympy.simplify.trigsimp module<a class="headerlink" href="#module-modelparameters.sympy.simplify.trigsimp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.trigsimp.exptrigsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.trigsimp.</span></span><span class="sig-name descname"><span class="pre">exptrigsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/trigsimp.html#exptrigsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.trigsimp.exptrigsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplifies exponential / trigonometric / hyperbolic functions.
When <code class="docutils literal notranslate"><span class="pre">simplify</span></code> is True (default) the expression obtained after the
simplification step will be then be passed through simplify to
precondition it so the final transformations will be applied.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">exptrigsimp</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">sinh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">z</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exptrigsimp</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
<span class="go">2*cosh(z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exptrigsimp</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">sinh</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">exp(-z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.trigsimp.futrig">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.trigsimp.</span></span><span class="sig-name descname"><span class="pre">futrig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/trigsimp.html#futrig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.trigsimp.futrig" title="Permalink to this definition">¶</a></dt>
<dd><p>Return simplified <code class="docutils literal notranslate"><span class="pre">e</span></code> using Fu-like transformations.
This is not the “Fu” algorithm. This is called by default
from <code class="docutils literal notranslate"><span class="pre">trigsimp</span></code>. By default, hyperbolics subexpressions
will be simplified, but this can be disabled by setting
<code class="docutils literal notranslate"><span class="pre">hyper=False</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">trigsimp</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">sinh</span><span class="p">,</span> <span class="n">tanh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.trigsimp</span> <span class="kn">import</span> <span class="n">futrig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">tan(x)**(-2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">futrig</span><span class="p">(</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">cosh(x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.trigsimp.trigsimp">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.trigsimp.</span></span><span class="sig-name descname"><span class="pre">trigsimp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">opts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/trigsimp.html#trigsimp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.trigsimp.trigsimp" title="Permalink to this definition">¶</a></dt>
<dd><p>reduces expression by using known trig identities</p>
<p class="rubric">Notes</p>
<p>method:
- Determine the method to use. Valid choices are ‘matching’ (default),
‘groebner’, ‘combined’, and ‘fu’. If ‘matching’, simplify the
expression recursively by targeting common patterns. If ‘groebner’, apply
an experimental groebner basis algorithm. In this case further options
are forwarded to <code class="docutils literal notranslate"><span class="pre">trigsimp_groebner</span></code>, please refer to its docstring.
If ‘combined’, first run the groebner basis algorithm with small
default parameters, then run the ‘matching’ algorithm. ‘fu’ runs the
collection of trigonometric transformations described by Fu, et al.
(see the <cite>fu</cite> docstring).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">trigsimp</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Simplification occurs wherever trigonometric functions are located.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="go">log(2)</span>
</pre></div>
</div>
<p>Using <cite>method=”groebner”</cite> (or <cite>“combined”</cite>) might lead to greater
simplification.</p>
<p>The old trigsimp routine can be accessed as with method ‘old’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">coth</span><span class="p">,</span> <span class="n">tanh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">7</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">coth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">t</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">tanh(x)**7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.trigsimp.trigsimp_groebner">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.trigsimp.</span></span><span class="sig-name descname"><span class="pre">trigsimp_groebner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grlex'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynomial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/trigsimp.html#trigsimp_groebner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.trigsimp.trigsimp_groebner" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify trigonometric expressions using a groebner basis algorithm.</p>
<p>This routine takes a fraction involving trigonometric or hyperbolic
expressions, and tries to simplify it. The primary metric is the
total degree. Some attempts are made to choose the simplest possible
expression of the minimal degree, but this is non-rigorous, and also
very slow (see the <code class="docutils literal notranslate"><span class="pre">quick=True</span></code> option).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">polynomial</span></code> is set to True, instead of simplifying numerator and
denominator together, this function just brings numerator and denominator
into a canonical form. This is much faster, but has potentially worse
results. However, if the input is a polynomial, then the result is
guaranteed to be an equivalent polynomial of minimal degree.</p>
<p>The most important option is hints. Its entries can be any of the
following:</p>
<ul class="simple">
<li><p>a natural number</p></li>
<li><p>a function</p></li>
<li><p>an iterable of the form (func, var1, var2, …)</p></li>
<li><p>anything else, interpreted as a generator</p></li>
</ul>
<p>A number is used to indicate that the search space should be increased.
A function is used to indicate that said function is likely to occur in a
simplified expression.
An iterable is used indicate that func(var1 + var2 + …) is likely to
occur in a simplified .
An additional generator also indicates that it is likely to occur.
(See examples below).</p>
<p>This routine carries out various computationally intensive algorithms.
The option <code class="docutils literal notranslate"><span class="pre">quick=True</span></code> can be used to suppress one particularly slow
step (at the expense of potentially more complicated results, but never at
the expense of increased total degree).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sinh</span><span class="p">,</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">tanh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.trigsimp</span> <span class="kn">import</span> <span class="n">trigsimp_groebner</span>
</pre></div>
</div>
<p>Suppose you want to simplify <code class="docutils literal notranslate"><span class="pre">sin(x)*cos(x)</span></code>. Naively, nothing happens:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ex</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
<span class="go">sin(x)*cos(x)</span>
</pre></div>
</div>
<p>This is because <code class="docutils literal notranslate"><span class="pre">trigsimp_groebner</span></code> only looks for a simplification
involving just <code class="docutils literal notranslate"><span class="pre">sin(x)</span></code> and <code class="docutils literal notranslate"><span class="pre">cos(x)</span></code>. You can tell it to also try
<code class="docutils literal notranslate"><span class="pre">2*x</span></code> by passing <code class="docutils literal notranslate"><span class="pre">hints=[2]</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">sin(2*x)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">-cos(2*x)</span>
</pre></div>
</div>
<p>Increasing the search space this way can quickly become expensive. A much
faster way is to give a specific expression that is likely to occur:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)])</span>
<span class="go">sin(2*x)/2</span>
</pre></div>
</div>
<p>Hyperbolic expressions are similarly supported:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*cosh(x)</span>
</pre></div>
</div>
<p>Note how no hints had to be passed, since the expression already involved
<code class="docutils literal notranslate"><span class="pre">2*x</span></code>.</p>
<p>The tangent function is also supported. You can either pass <code class="docutils literal notranslate"><span class="pre">tan</span></code> in the
hints, to indicate that than should be tried whenever cosine or sine are,
or you can pass a specific generator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">hints</span><span class="o">=</span><span class="p">[</span><span class="n">tan</span><span class="p">])</span>
<span class="go">tan(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">hints</span><span class="o">=</span><span class="p">[</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
<span class="go">tanh(x)</span>
</pre></div>
</div>
<p>Finally, you can use the iterable form to suggest that angle sum formulae
should be tried:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">tan</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp_groebner</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">[(</span><span class="n">tan</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
<span class="go">tan(x + y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modelparameters.sympy.simplify.trigsimp.trigsimp_old">
<span class="sig-prename descclassname"><span class="pre">modelparameters.sympy.simplify.trigsimp.</span></span><span class="sig-name descname"><span class="pre">trigsimp_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">opts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/modelparameters/sympy/simplify/trigsimp.html#trigsimp_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modelparameters.sympy.simplify.trigsimp.trigsimp_old" title="Permalink to this definition">¶</a></dt>
<dd><p>reduces expression by using known trig identities</p>
<p class="rubric">Notes</p>
<p>deep:
- Apply trigsimp inside all objects with arguments</p>
<p>recursive:
- Use common subexpression elimination (cse()) and apply
trigsimp recursively (this is quite expensive if the
expression is large)</p>
<p>method:
- Determine the method to use. Valid choices are ‘matching’ (default),
‘groebner’, ‘combined’, ‘fu’ and ‘futrig’. If ‘matching’, simplify the
expression recursively by pattern matching. If ‘groebner’, apply an
experimental groebner basis algorithm. In this case further options
are forwarded to <code class="docutils literal notranslate"><span class="pre">trigsimp_groebner</span></code>, please refer to its docstring.
If ‘combined’, first run the groebner basis algorithm with small
default parameters, then run the ‘matching’ algorithm. ‘fu’ runs the
collection of trigonometric transformations described by Fu, et al.
(see the <cite>fu</cite> docstring) while <cite>futrig</cite> runs a subset of Fu-transforms
that mimic the behavior of <cite>trigsimp</cite>.</p>
<p>compare:
- show input and output from <cite>trigsimp</cite> and <cite>futrig</cite> when different,
but returns the <cite>trigsimp</cite> value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">trigsimp</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">sinh</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">..abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(2*sin(x)**2 + 2*cos(x)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">log(2)</span>
</pre></div>
</div>
<p>Using <cite>method=”groebner”</cite> (or <cite>“combined”</cite>) can sometimes lead to a lot
more simplification:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-sin(x) + 1)/cos(x) + cos(x)/(-sin(x) + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;groebner&quot;</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">2/cos(x)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigsimp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">compare</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">      futrig: tan(x)**2</span>
<span class="go">cot(x)**(-2)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-modelparameters.sympy.simplify">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-modelparameters.sympy.simplify" title="Permalink to this heading">¶</a></h2>
<p>The module helps converting SymPy expressions into shorter forms of them.</p>
<p>for example:
the expression E**(pi*I) will be converted into -1
the expression (x+x)**2 will be converted into 4*x**2</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">modelparameters.sympy.simplify package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.combsimp">modelparameters.sympy.simplify.combsimp module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.combsimp.combsimp"><code class="docutils literal notranslate"><span class="pre">combsimp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.cse_main">modelparameters.sympy.simplify.cse_main module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.cse"><code class="docutils literal notranslate"><span class="pre">cse()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.cse_separate"><code class="docutils literal notranslate"><span class="pre">cse_separate()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.opt_cse"><code class="docutils literal notranslate"><span class="pre">opt_cse()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.postprocess_for_cse"><code class="docutils literal notranslate"><span class="pre">postprocess_for_cse()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.preprocess_for_cse"><code class="docutils literal notranslate"><span class="pre">preprocess_for_cse()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.reps_toposort"><code class="docutils literal notranslate"><span class="pre">reps_toposort()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_main.tree_cse"><code class="docutils literal notranslate"><span class="pre">tree_cse()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.cse_opts">modelparameters.sympy.simplify.cse_opts module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_opts.sub_post"><code class="docutils literal notranslate"><span class="pre">sub_post()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.cse_opts.sub_pre"><code class="docutils literal notranslate"><span class="pre">sub_pre()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.epathtools">modelparameters.sympy.simplify.epathtools module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.EPath"><code class="docutils literal notranslate"><span class="pre">EPath</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.EPath.apply"><code class="docutils literal notranslate"><span class="pre">EPath.apply()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.EPath.select"><code class="docutils literal notranslate"><span class="pre">EPath.select()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.epathtools.epath"><code class="docutils literal notranslate"><span class="pre">epath()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.fu">modelparameters.sympy.simplify.fu module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.L"><code class="docutils literal notranslate"><span class="pre">L()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR0"><code class="docutils literal notranslate"><span class="pre">TR0()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR1"><code class="docutils literal notranslate"><span class="pre">TR1()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR10"><code class="docutils literal notranslate"><span class="pre">TR10()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR10i"><code class="docutils literal notranslate"><span class="pre">TR10i()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR11"><code class="docutils literal notranslate"><span class="pre">TR11()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR111"><code class="docutils literal notranslate"><span class="pre">TR111()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR12"><code class="docutils literal notranslate"><span class="pre">TR12()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR12i"><code class="docutils literal notranslate"><span class="pre">TR12i()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR13"><code class="docutils literal notranslate"><span class="pre">TR13()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR14"><code class="docutils literal notranslate"><span class="pre">TR14()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR15"><code class="docutils literal notranslate"><span class="pre">TR15()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR16"><code class="docutils literal notranslate"><span class="pre">TR16()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR2"><code class="docutils literal notranslate"><span class="pre">TR2()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR22"><code class="docutils literal notranslate"><span class="pre">TR22()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR2i"><code class="docutils literal notranslate"><span class="pre">TR2i()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR3"><code class="docutils literal notranslate"><span class="pre">TR3()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR4"><code class="docutils literal notranslate"><span class="pre">TR4()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR5"><code class="docutils literal notranslate"><span class="pre">TR5()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR6"><code class="docutils literal notranslate"><span class="pre">TR6()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR7"><code class="docutils literal notranslate"><span class="pre">TR7()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR8"><code class="docutils literal notranslate"><span class="pre">TR8()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TR9"><code class="docutils literal notranslate"><span class="pre">TR9()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.TRmorrie"><code class="docutils literal notranslate"><span class="pre">TRmorrie()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.as_f_sign_1"><code class="docutils literal notranslate"><span class="pre">as_f_sign_1()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.fu"><code class="docutils literal notranslate"><span class="pre">fu()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.hyper_as_trig"><code class="docutils literal notranslate"><span class="pre">hyper_as_trig()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.process_common_addends"><code class="docutils literal notranslate"><span class="pre">process_common_addends()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.fu.trig_split"><code class="docutils literal notranslate"><span class="pre">trig_split()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.hyperexpand">modelparameters.sympy.simplify.hyperexpand module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Formula"><code class="docutils literal notranslate"><span class="pre">Formula</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Formula.closed_form"><code class="docutils literal notranslate"><span class="pre">Formula.closed_form</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Formula.find_instantiations"><code class="docutils literal notranslate"><span class="pre">Formula.find_instantiations()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.FormulaCollection"><code class="docutils literal notranslate"><span class="pre">FormulaCollection</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.FormulaCollection.lookup_origin"><code class="docutils literal notranslate"><span class="pre">FormulaCollection.lookup_origin()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.G_Function"><code class="docutils literal notranslate"><span class="pre">G_Function</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.args"><code class="docutils literal notranslate"><span class="pre">G_Function.args</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.compute_buckets"><code class="docutils literal notranslate"><span class="pre">G_Function.compute_buckets()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.default_assumptions"><code class="docutils literal notranslate"><span class="pre">G_Function.default_assumptions</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.G_Function.signature"><code class="docutils literal notranslate"><span class="pre">G_Function.signature</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function"><code class="docutils literal notranslate"><span class="pre">Hyper_Function</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.args"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.args</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.build_invariants"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.build_invariants()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.default_assumptions"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.default_assumptions</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.difficulty"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.difficulty()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.gamma"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.gamma</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Hyper_Function.sizes"><code class="docutils literal notranslate"><span class="pre">Hyper_Function.sizes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula"><code class="docutils literal notranslate"><span class="pre">MeijerFormula</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula.closed_form"><code class="docutils literal notranslate"><span class="pre">MeijerFormula.closed_form</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormula.try_instantiate"><code class="docutils literal notranslate"><span class="pre">MeijerFormula.try_instantiate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection"><code class="docutils literal notranslate"><span class="pre">MeijerFormulaCollection</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerFormulaCollection.lookup_origin"><code class="docutils literal notranslate"><span class="pre">MeijerFormulaCollection.lookup_origin()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftA"><code class="docutils literal notranslate"><span class="pre">MeijerShiftA</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftB"><code class="docutils literal notranslate"><span class="pre">MeijerShiftB</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftC"><code class="docutils literal notranslate"><span class="pre">MeijerShiftC</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerShiftD"><code class="docutils literal notranslate"><span class="pre">MeijerShiftD</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftA"><code class="docutils literal notranslate"><span class="pre">MeijerUnShiftA</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftB"><code class="docutils literal notranslate"><span class="pre">MeijerUnShiftB</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftC"><code class="docutils literal notranslate"><span class="pre">MeijerUnShiftC</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MeijerUnShiftD"><code class="docutils literal notranslate"><span class="pre">MeijerUnShiftD</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.MultOperator"><code class="docutils literal notranslate"><span class="pre">MultOperator</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator"><code class="docutils literal notranslate"><span class="pre">Operator</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.Operator.apply"><code class="docutils literal notranslate"><span class="pre">Operator.apply()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder"><code class="docutils literal notranslate"><span class="pre">ReduceOrder</span></code></a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_minus"><code class="docutils literal notranslate"><span class="pre">ReduceOrder.meijer_minus()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.ReduceOrder.meijer_plus"><code class="docutils literal notranslate"><span class="pre">ReduceOrder.meijer_plus()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.ShiftA"><code class="docutils literal notranslate"><span class="pre">ShiftA</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.ShiftB"><code class="docutils literal notranslate"><span class="pre">ShiftB</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.UnShiftA"><code class="docutils literal notranslate"><span class="pre">UnShiftA</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.UnShiftB"><code class="docutils literal notranslate"><span class="pre">UnShiftB</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.add_formulae"><code class="docutils literal notranslate"><span class="pre">add_formulae()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.add_meijerg_formulae"><code class="docutils literal notranslate"><span class="pre">add_meijerg_formulae()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.apply_operators"><code class="docutils literal notranslate"><span class="pre">apply_operators()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.build_hypergeometric_formula"><code class="docutils literal notranslate"><span class="pre">build_hypergeometric_formula()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.debug"><code class="docutils literal notranslate"><span class="pre">debug()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.devise_plan"><code class="docutils literal notranslate"><span class="pre">devise_plan()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.devise_plan_meijer"><code class="docutils literal notranslate"><span class="pre">devise_plan_meijer()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.hyperexpand"><code class="docutils literal notranslate"><span class="pre">hyperexpand()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.hyperexpand_special"><code class="docutils literal notranslate"><span class="pre">hyperexpand_special()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.make_derivative_operator"><code class="docutils literal notranslate"><span class="pre">make_derivative_operator()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.make_simp"><code class="docutils literal notranslate"><span class="pre">make_simp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.reduce_order"><code class="docutils literal notranslate"><span class="pre">reduce_order()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.reduce_order_meijer"><code class="docutils literal notranslate"><span class="pre">reduce_order_meijer()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.try_lerchphi"><code class="docutils literal notranslate"><span class="pre">try_lerchphi()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.try_polynomial"><code class="docutils literal notranslate"><span class="pre">try_polynomial()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.hyperexpand.try_shifted_sum"><code class="docutils literal notranslate"><span class="pre">try_shifted_sum()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#modelparameters-sympy-simplify-hyperexpand-doc-module">modelparameters.sympy.simplify.hyperexpand_doc module</a></li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.powsimp">modelparameters.sympy.simplify.powsimp module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.powsimp.powdenest"><code class="docutils literal notranslate"><span class="pre">powdenest()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.powsimp.powsimp"><code class="docutils literal notranslate"><span class="pre">powsimp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.radsimp">modelparameters.sympy.simplify.radsimp module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect"><code class="docutils literal notranslate"><span class="pre">collect()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_const"><code class="docutils literal notranslate"><span class="pre">collect_const()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.collect_sqrt"><code class="docutils literal notranslate"><span class="pre">collect_sqrt()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.denom"><code class="docutils literal notranslate"><span class="pre">denom()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.denom_expand"><code class="docutils literal notranslate"><span class="pre">denom_expand()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.expand_denom"><code class="docutils literal notranslate"><span class="pre">expand_denom()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.expand_fraction"><code class="docutils literal notranslate"><span class="pre">expand_fraction()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.expand_numer"><code class="docutils literal notranslate"><span class="pre">expand_numer()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.fraction"><code class="docutils literal notranslate"><span class="pre">fraction()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.fraction_expand"><code class="docutils literal notranslate"><span class="pre">fraction_expand()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.numer"><code class="docutils literal notranslate"><span class="pre">numer()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.numer_expand"><code class="docutils literal notranslate"><span class="pre">numer_expand()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.rad_rationalize"><code class="docutils literal notranslate"><span class="pre">rad_rationalize()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.radsimp"><code class="docutils literal notranslate"><span class="pre">radsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.rcollect"><code class="docutils literal notranslate"><span class="pre">rcollect()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.radsimp.split_surds"><code class="docutils literal notranslate"><span class="pre">split_surds()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.ratsimp">modelparameters.sympy.simplify.ratsimp module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.ratsimp.ratsimp"><code class="docutils literal notranslate"><span class="pre">ratsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.ratsimp.ratsimpmodprime"><code class="docutils literal notranslate"><span class="pre">ratsimpmodprime()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.simplify">modelparameters.sympy.simplify.simplify module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.besselsimp"><code class="docutils literal notranslate"><span class="pre">besselsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.bottom_up"><code class="docutils literal notranslate"><span class="pre">bottom_up()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.clear_coefficients"><code class="docutils literal notranslate"><span class="pre">clear_coefficients()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.factor_sum"><code class="docutils literal notranslate"><span class="pre">factor_sum()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.hypersimilar"><code class="docutils literal notranslate"><span class="pre">hypersimilar()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.hypersimp"><code class="docutils literal notranslate"><span class="pre">hypersimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.logcombine"><code class="docutils literal notranslate"><span class="pre">logcombine()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.nsimplify"><code class="docutils literal notranslate"><span class="pre">nsimplify()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.nthroot"><code class="docutils literal notranslate"><span class="pre">nthroot()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.posify"><code class="docutils literal notranslate"><span class="pre">posify()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.product_mul"><code class="docutils literal notranslate"><span class="pre">product_mul()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.product_simplify"><code class="docutils literal notranslate"><span class="pre">product_simplify()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.separatevars"><code class="docutils literal notranslate"><span class="pre">separatevars()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.signsimp"><code class="docutils literal notranslate"><span class="pre">signsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.simplify"><code class="docutils literal notranslate"><span class="pre">simplify()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.sum_add"><code class="docutils literal notranslate"><span class="pre">sum_add()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.sum_combine"><code class="docutils literal notranslate"><span class="pre">sum_combine()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.simplify.sum_simplify"><code class="docutils literal notranslate"><span class="pre">sum_simplify()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.sqrtdenest">modelparameters.sympy.simplify.sqrtdenest module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.SqrtdenestStopIteration"><code class="docutils literal notranslate"><span class="pre">SqrtdenestStopIteration</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.is_algebraic"><code class="docutils literal notranslate"><span class="pre">is_algebraic()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.is_sqrt"><code class="docutils literal notranslate"><span class="pre">is_sqrt()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.sqrt_biquadratic_denest"><code class="docutils literal notranslate"><span class="pre">sqrt_biquadratic_denest()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.sqrt_depth"><code class="docutils literal notranslate"><span class="pre">sqrt_depth()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.sqrtdenest.sqrtdenest"><code class="docutils literal notranslate"><span class="pre">sqrtdenest()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.traversaltools">modelparameters.sympy.simplify.traversaltools module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.traversaltools.use"><code class="docutils literal notranslate"><span class="pre">use()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify.trigsimp">modelparameters.sympy.simplify.trigsimp module</a><ul>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.trigsimp.exptrigsimp"><code class="docutils literal notranslate"><span class="pre">exptrigsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.trigsimp.futrig"><code class="docutils literal notranslate"><span class="pre">futrig()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.trigsimp.trigsimp"><code class="docutils literal notranslate"><span class="pre">trigsimp()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.trigsimp.trigsimp_groebner"><code class="docutils literal notranslate"><span class="pre">trigsimp_groebner()</span></code></a></li>
<li><a class="reference internal" href="#modelparameters.sympy.simplify.trigsimp.trigsimp_old"><code class="docutils literal notranslate"><span class="pre">trigsimp_old()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-modelparameters.sympy.simplify">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="modelparameters.sympy.sets.html"
                          title="previous chapter">modelparameters.sympy.sets package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="modelparameters.sympy.solvers.html"
                          title="next chapter">modelparameters.sympy.solvers package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modelparameters.sympy.simplify.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelparameters.sympy.solvers.html" title="modelparameters.sympy.solvers package"
             >next</a> |</li>
        <li class="right" >
          <a href="modelparameters.sympy.sets.html" title="modelparameters.sympy.sets package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">modelparameters 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modelparameters.html" >modelparameters package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="modelparameters.sympy.html" >modelparameters.sympy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">modelparameters.sympy.simplify package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Johan Hake, Henrik Finsberg.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>